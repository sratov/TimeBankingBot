2025-05-26 22:31:42,691 - main - INFO - ================================================================================
2025-05-26 22:31:42,691 - main - INFO - Starting Time Banking API
2025-05-26 22:31:42,691 - main - INFO - ================================================================================
2025-05-26 22:31:42,691 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-26 22:32:52,438 - main - INFO - ================================================================================
2025-05-26 22:32:52,438 - main - INFO - Starting Time Banking API
2025-05-26 22:32:52,438 - main - INFO - ================================================================================
2025-05-26 22:32:52,438 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-26 22:33:11,762 - main - INFO - ================================================================================
2025-05-26 22:33:11,762 - main - INFO - Starting Time Banking API
2025-05-26 22:33:11,762 - main - INFO - ================================================================================
2025-05-26 22:33:11,766 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-26 22:36:43,036 - main - INFO - ================================================================================
2025-05-26 22:36:43,036 - main - INFO - Starting Time Banking API
2025-05-26 22:36:43,036 - main - INFO - Starting Time Banking API
2025-05-26 22:36:43,036 - main - INFO - ================================================================================
2025-05-26 22:36:43,036 - main - INFO - ================================================================================
2025-05-26 22:36:43,036 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-26 22:37:52,417 - main - INFO - ================================================================================
2025-05-26 22:37:52,417 - main - INFO - Starting Time Banking API
2025-05-26 22:37:52,417 - main - INFO - ================================================================================
2025-05-26 22:37:52,417 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-26 22:38:11,817 - main - INFO - ================================================================================
2025-05-26 22:38:11,817 - main - INFO - Starting Time Banking API
2025-05-26 22:38:11,817 - main - INFO - ================================================================================
2025-05-26 22:38:11,817 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:05:39,946 - main - INFO - ================================================================================
2025-05-27 15:05:39,946 - main - INFO - Starting Time Banking API
2025-05-27 15:05:39,946 - main - INFO - ================================================================================
2025-05-27 15:05:39,948 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:10:13,538 - main - INFO - ================================================================================
2025-05-27 15:10:13,539 - main - INFO - Starting Time Banking API
2025-05-27 15:10:13,540 - main - INFO - ================================================================================
2025-05-27 15:10:13,540 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:11:13,212 - main - INFO - [93f3687d-ef62-4a68-bb82-f2fd1995310b] Request from 127.0.0.1:51067 - POST /auth/telegram
2025-05-27 15:11:13,214 - main - INFO - [93f3687d-ef62-4a68-bb82-f2fd1995310b] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'}
2025-05-27 15:11:13,215 - main - INFO - [93f3687d-ef62-4a68-bb82-f2fd1995310b] Request body: {}
2025-05-27 15:11:13,218 - main - INFO - [e1582ecb-d226-4843-a794-fdffb7ed9ad9] Request from 127.0.0.1:51068 - POST /auth/telegram
2025-05-27 15:11:13,219 - main - INFO - [e1582ecb-d226-4843-a794-fdffb7ed9ad9] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'}
2025-05-27 15:11:13,220 - main - INFO - [e1582ecb-d226-4843-a794-fdffb7ed9ad9] Request body: {}
2025-05-27 15:11:13,223 - main - INFO - 

********************************************************************************
2025-05-27 15:11:13,224 - main - INFO - === Starting Telegram Authentication ===
2025-05-27 15:11:13,225 - main - INFO - ********************************************************************************
2025-05-27 15:11:13,226 - main - DEBUG - Request headers:
2025-05-27 15:11:13,227 - main - DEBUG -   host: localhost:8000
2025-05-27 15:11:13,228 - main - DEBUG -   connection: keep-alive
2025-05-27 15:11:13,229 - main - DEBUG -   content-length: 2
2025-05-27 15:11:13,229 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-27 15:11:13,230 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-27 15:11:13,231 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-27 15:11:13,231 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-27 15:11:13,232 - main - DEBUG -   content-type: application/json
2025-05-27 15:11:13,233 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-27 15:11:13,234 - main - DEBUG -   origin: https://7e70-77-91-101-132.ngrok-free.app
2025-05-27 15:11:13,234 - main - DEBUG -   sec-fetch-site: cross-site
2025-05-27 15:11:13,235 - main - DEBUG -   sec-fetch-mode: cors
2025-05-27 15:11:13,235 - main - DEBUG -   sec-fetch-dest: empty
2025-05-27 15:11:13,236 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-27 15:11:13,237 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-27 15:11:13,237 - main - DEBUG - Query parameters:
2025-05-27 15:11:13,238 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,239 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'
2025-05-27 15:11:13,241 - main - DEBUG - Parsed data parameters:
2025-05-27 15:11:13,242 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TRGMsro
2025-05-27 15:11:13,242 - main - DEBUG -   user: %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,243 - main - DEBUG -   auth_date: 1748347857
2025-05-27 15:11:13,243 - main - DEBUG -   signature: SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw
2025-05-27 15:11:13,244 - main - DEBUG -   hash: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,245 - main - DEBUG - Extracted hash value: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,246 - main - INFO - Verifying Telegram hash...
2025-05-27 15:11:13,248 - auth - DEBUG - 
==================================================
2025-05-27 15:11:13,248 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-27 15:11:13,249 - auth - DEBUG - ==================================================
2025-05-27 15:11:13,250 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-27 15:11:13,250 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-27 15:11:13,251 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'
2025-05-27 15:11:13,252 - auth - DEBUG - received_hash: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,253 - auth - DEBUG - Parsed param: query_id = AAFreO00AAAAAGt47TRGMsro
2025-05-27 15:11:13,253 - auth - DEBUG - Parsed param: user = %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,255 - auth - DEBUG - Parsed param: auth_date = 1748347857
2025-05-27 15:11:13,255 - auth - DEBUG - Parsed param: signature = SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw
2025-05-27 15:11:13,256 - auth - DEBUG - Parsed param: hash = 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,257 - auth - DEBUG - Extracted hash value: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,258 - auth - DEBUG - data_check_string (repr): 'auth_date=1748347857\nquery_id=AAFreO00AAAAAGt47TRGMsro\nuser=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D'
2025-05-27 15:11:13,260 - auth - DEBUG - Generated secret key (hex): 379aa67b195bd99b7a2e2819d1682d190edf51ee0d148183fb6708da92fdf532
2025-05-27 15:11:13,261 - auth - DEBUG - Calculated hash: c15ad5e36ea5e2e6198108abc708b5b8d0d3fb0d7182793de4f5c60de8b5d86a
2025-05-27 15:11:13,261 - auth - DEBUG - Received hash:   328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,262 - auth - DEBUG - Hash verification result: False
2025-05-27 15:11:13,263 - auth - WARNING - Hash verification failed! BYPASSING FOR DEBUGGING.
2025-05-27 15:11:13,263 - main - INFO - Hash verification successful
2025-05-27 15:11:13,264 - main - INFO - Parsing user data...
2025-05-27 15:11:13,264 - main - DEBUG - Raw user data: %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,265 - main - DEBUG - URL-decoded user data: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-27 15:11:13,266 - main - DEBUG - Parsed user_info: {'id': 887978091, 'first_name': '.', 'last_name': '.', 'username': 'sar_a_to_v', 'language_code': 'ru', 'allows_write_to_pm': True, 'photo_url': 'https://t.me/i/userpic/320/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg'}
2025-05-27 15:11:13,267 - main - DEBUG - Converted telegram_id to int: 887978091 (type: <class 'int'>)
2025-05-27 15:11:13,267 - main - INFO - Looking up user with telegram_id: 887978091
2025-05-27 15:11:13,270 - main - INFO - Found existing user: sar_a_to_v (ID: 2, Telegram ID: 887978091)
2025-05-27 15:11:13,271 - main - INFO - Updated avatar URL to: https://t.me/i/userpic/320/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg
2025-05-27 15:11:13,284 - main - INFO - Creating JWT token for user: sar_a_to_v
2025-05-27 15:11:13,286 - main - DEBUG - Token data: {'sub': '2', 'telegram_id': '887978091', 'username': 'sar_a_to_v'}
2025-05-27 15:11:13,308 - auth - DEBUG - JWT created for sar_a_to_v (exp 2025-05-28 12:11:13.286900)
2025-05-27 15:11:13,309 - main - INFO - JWT token created successfully
2025-05-27 15:11:13,310 - main - INFO - === Authentication Successful ===
2025-05-27 15:11:13,311 - main - INFO - ********************************************************************************


2025-05-27 15:11:13,313 - main - INFO - 

********************************************************************************
2025-05-27 15:11:13,313 - main - INFO - === Starting Telegram Authentication ===
2025-05-27 15:11:13,314 - main - INFO - ********************************************************************************
2025-05-27 15:11:13,315 - main - DEBUG - Request headers:
2025-05-27 15:11:13,315 - main - DEBUG -   host: localhost:8000
2025-05-27 15:11:13,316 - main - DEBUG -   connection: keep-alive
2025-05-27 15:11:13,316 - main - DEBUG -   content-length: 2
2025-05-27 15:11:13,318 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-27 15:11:13,318 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-27 15:11:13,319 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-27 15:11:13,319 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-27 15:11:13,320 - main - DEBUG -   content-type: application/json
2025-05-27 15:11:13,320 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-27 15:11:13,321 - main - DEBUG -   origin: https://7e70-77-91-101-132.ngrok-free.app
2025-05-27 15:11:13,321 - main - DEBUG -   sec-fetch-site: cross-site
2025-05-27 15:11:13,322 - main - DEBUG -   sec-fetch-mode: cors
2025-05-27 15:11:13,322 - main - DEBUG -   sec-fetch-dest: empty
2025-05-27 15:11:13,323 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-27 15:11:13,323 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-27 15:11:13,324 - main - DEBUG - Query parameters:
2025-05-27 15:11:13,324 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,325 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'
2025-05-27 15:11:13,326 - main - DEBUG - Parsed data parameters:
2025-05-27 15:11:13,327 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TRGMsro
2025-05-27 15:11:13,327 - main - DEBUG -   user: %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,328 - main - DEBUG -   auth_date: 1748347857
2025-05-27 15:11:13,329 - main - DEBUG -   signature: SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw
2025-05-27 15:11:13,330 - main - DEBUG -   hash: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,330 - main - DEBUG - Extracted hash value: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,331 - main - INFO - Verifying Telegram hash...
2025-05-27 15:11:13,331 - auth - DEBUG - 
==================================================
2025-05-27 15:11:13,333 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-27 15:11:13,333 - auth - DEBUG - ==================================================
2025-05-27 15:11:13,334 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-27 15:11:13,334 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-27 15:11:13,335 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TRGMsro&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748347857&signature=SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw&hash=328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077'
2025-05-27 15:11:13,335 - auth - DEBUG - received_hash: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,336 - auth - DEBUG - Parsed param: query_id = AAFreO00AAAAAGt47TRGMsro
2025-05-27 15:11:13,337 - auth - DEBUG - Parsed param: user = %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,337 - auth - DEBUG - Parsed param: auth_date = 1748347857
2025-05-27 15:11:13,337 - auth - DEBUG - Parsed param: signature = SxsBATJpj0FyX6qec1b0Px2nVNvYi_3Qg3X9jknb0zHaZiVehZpr3is38Jum6O5QSj9HCx5Ec4dtDejxJUu9Cw
2025-05-27 15:11:13,339 - auth - DEBUG - Parsed param: hash = 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,340 - auth - DEBUG - Extracted hash value: 328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,340 - auth - DEBUG - data_check_string (repr): 'auth_date=1748347857\nquery_id=AAFreO00AAAAAGt47TRGMsro\nuser=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D'
2025-05-27 15:11:13,341 - auth - DEBUG - Generated secret key (hex): 379aa67b195bd99b7a2e2819d1682d190edf51ee0d148183fb6708da92fdf532
2025-05-27 15:11:13,342 - auth - DEBUG - Calculated hash: c15ad5e36ea5e2e6198108abc708b5b8d0d3fb0d7182793de4f5c60de8b5d86a
2025-05-27 15:11:13,342 - auth - DEBUG - Received hash:   328b19cfac31481752b6059a606307bb95124140b427c8b186c4dc4c26c28077
2025-05-27 15:11:13,344 - auth - DEBUG - Hash verification result: False
2025-05-27 15:11:13,345 - auth - WARNING - Hash verification failed! BYPASSING FOR DEBUGGING.
2025-05-27 15:11:13,346 - main - INFO - Hash verification successful
2025-05-27 15:11:13,347 - main - INFO - Parsing user data...
2025-05-27 15:11:13,347 - main - DEBUG - Raw user data: %7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D
2025-05-27 15:11:13,348 - main - DEBUG - URL-decoded user data: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-27 15:11:13,349 - main - DEBUG - Parsed user_info: {'id': 887978091, 'first_name': '.', 'last_name': '.', 'username': 'sar_a_to_v', 'language_code': 'ru', 'allows_write_to_pm': True, 'photo_url': 'https://t.me/i/userpic/320/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg'}
2025-05-27 15:11:13,349 - main - DEBUG - Converted telegram_id to int: 887978091 (type: <class 'int'>)
2025-05-27 15:11:13,350 - main - INFO - Looking up user with telegram_id: 887978091
2025-05-27 15:11:13,355 - main - INFO - Found existing user: sar_a_to_v (ID: 2, Telegram ID: 887978091)
2025-05-27 15:11:13,356 - main - INFO - Creating JWT token for user: sar_a_to_v
2025-05-27 15:11:13,357 - main - DEBUG - Token data: {'sub': '2', 'telegram_id': '887978091', 'username': 'sar_a_to_v'}
2025-05-27 15:11:13,358 - auth - DEBUG - JWT created for sar_a_to_v (exp 2025-05-28 12:11:13.358493)
2025-05-27 15:11:13,359 - main - INFO - JWT token created successfully
2025-05-27 15:11:13,360 - main - INFO - === Authentication Successful ===
2025-05-27 15:11:13,361 - main - INFO - ********************************************************************************


2025-05-27 15:11:13,362 - main - INFO - [93f3687d-ef62-4a68-bb82-f2fd1995310b] Response status: 200 - Completed in 0.1453s
2025-05-27 15:11:13,364 - main - INFO - [e1582ecb-d226-4843-a794-fdffb7ed9ad9] Response status: 200 - Completed in 0.1433s
2025-05-27 15:11:13,374 - main - INFO - [28111181-caa2-490d-9f46-c692ed10bb1e] Request from 127.0.0.1:51068 - GET /listings/
2025-05-27 15:11:13,376 - main - INFO - [28111181-caa2-490d-9f46-c692ed10bb1e] Query params: {'skip': '0', 'limit': '5'}
2025-05-27 15:11:13,394 - main - INFO - [28111181-caa2-490d-9f46-c692ed10bb1e] Response status: 200 - Completed in 0.0186s
2025-05-27 15:11:13,399 - main - INFO - [681c2111-63c1-43d4-94d2-da6488da6972] Request from 127.0.0.1:51068 - GET /listings/
2025-05-27 15:11:13,400 - main - INFO - [681c2111-63c1-43d4-94d2-da6488da6972] Query params: {'skip': '0', 'limit': '5'}
2025-05-27 15:11:13,406 - main - INFO - [681c2111-63c1-43d4-94d2-da6488da6972] Response status: 200 - Completed in 0.0053s
2025-05-27 15:11:19,557 - main - INFO - [db81e175-9eec-410d-a2b7-fa3866f7de07] Request from 127.0.0.1:51069 - GET /friends/
2025-05-27 15:11:19,572 - main - INFO - [db81e175-9eec-410d-a2b7-fa3866f7de07] Response status: 200 - Completed in 0.0147s
2025-05-27 15:11:19,577 - main - INFO - [9a3e91e9-9a91-4222-98a1-86fb5c16b8a4] Request from 127.0.0.1:51069 - GET /listings/user/2
2025-05-27 15:11:19,594 - main - INFO - [9a3e91e9-9a91-4222-98a1-86fb5c16b8a4] Response status: 200 - Completed in 0.0142s
2025-05-27 15:11:19,599 - main - INFO - [755b8927-3be2-4ad6-9220-3af54b9278a1] Request from 127.0.0.1:51069 - GET /friends/pending
2025-05-27 15:11:19,612 - main - INFO - [755b8927-3be2-4ad6-9220-3af54b9278a1] Response status: 200 - Completed in 0.0105s
2025-05-27 15:11:19,616 - main - INFO - [90a1a24b-a1fe-45fd-b849-e3eac4519743] Request from 127.0.0.1:51069 - GET /users/transactions
2025-05-27 15:11:19,628 - main - INFO - [90a1a24b-a1fe-45fd-b849-e3eac4519743] Response status: 200 - Completed in 0.0105s
2025-05-27 15:11:19,632 - main - INFO - [0ba1fe16-33c6-4d85-818f-f83483358de6] Request from 127.0.0.1:51069 - GET /friends/
2025-05-27 15:11:19,637 - main - INFO - [0ba1fe16-33c6-4d85-818f-f83483358de6] Response status: 200 - Completed in 0.0044s
2025-05-27 15:11:19,641 - main - INFO - [696f758e-5172-4560-817c-8940a31eee22] Request from 127.0.0.1:51069 - GET /listings/user/2
2025-05-27 15:11:19,648 - main - INFO - [696f758e-5172-4560-817c-8940a31eee22] Response status: 200 - Completed in 0.0050s
2025-05-27 15:11:19,652 - main - INFO - [e2ae088c-f523-4f0f-8b67-7e4629738134] Request from 127.0.0.1:51069 - GET /friends/pending
2025-05-27 15:11:19,658 - main - INFO - [e2ae088c-f523-4f0f-8b67-7e4629738134] Response status: 200 - Completed in 0.0055s
2025-05-27 15:11:19,662 - main - INFO - [cd051388-388a-46c8-9a7f-11dafc857391] Request from 127.0.0.1:51069 - GET /users/transactions
2025-05-27 15:11:19,668 - main - INFO - [cd051388-388a-46c8-9a7f-11dafc857391] Response status: 200 - Completed in 0.0055s
2025-05-27 15:11:19,938 - main - INFO - [25627fbb-ce3a-4963-a8e7-9fa2447b3e7d] Request from 127.0.0.1:51084 - GET /uploads/3/1.jpg
2025-05-27 15:11:20,001 - main - INFO - [25627fbb-ce3a-4963-a8e7-9fa2447b3e7d] Response status: 200 - Completed in 0.0628s
2025-05-27 15:26:22,106 - main - INFO - ================================================================================
2025-05-27 15:26:22,106 - main - INFO - Starting Time Banking API
2025-05-27 15:26:22,106 - main - INFO - ================================================================================
2025-05-27 15:26:22,106 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:28:31,659 - main - INFO - ================================================================================
2025-05-27 15:28:31,659 - main - INFO - Starting Time Banking API
2025-05-27 15:28:31,659 - main - INFO - ================================================================================
2025-05-27 15:28:31,659 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:41:22,904 - main - INFO - ================================================================================
2025-05-27 15:41:22,904 - main - INFO - Starting Time Banking API
2025-05-27 15:41:22,904 - main - INFO - ================================================================================
2025-05-27 15:41:22,906 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 15:55:27,873 - main - INFO - ================================================================================
2025-05-27 15:55:27,874 - main - INFO - Starting Time Banking API
2025-05-27 15:55:27,875 - main - INFO - ================================================================================
2025-05-27 15:55:27,875 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 16:39:19,733 - main - INFO - ================================================================================
2025-05-27 16:39:19,733 - main - INFO - Starting Time Banking API
2025-05-27 16:39:19,733 - main - INFO - ================================================================================
2025-05-27 16:39:19,733 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 16:49:19,707 - main - INFO - ================================================================================
2025-05-27 16:49:19,713 - main - INFO - Starting Time Banking API
2025-05-27 16:49:19,714 - main - INFO - ================================================================================
2025-05-27 16:49:19,714 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 16:51:28,026 - main - INFO - ================================================================================
2025-05-27 16:51:28,033 - main - INFO - Starting Time Banking API
2025-05-27 16:51:28,033 - main - INFO - ================================================================================
2025-05-27 16:51:28,033 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-27 16:56:31,510 - main - INFO - [a58da603-e03e-4b46-9cfb-b887414e4316] Request from 127.0.0.1:53698 - GET /auth/telegram
2025-05-27 16:56:31,510 - main - INFO - [a58da603-e03e-4b46-9cfb-b887414e4316] Response status: 405 - Completed in 0.0000s
2025-05-27 16:57:29,105 - main - INFO - [676fa4aa-9dd8-4656-a505-0e9a829c5779] Request from 127.0.0.1:53718 - POST /auth/telegram
2025-05-27 16:57:29,105 - main - INFO - 

********************************************************************************
2025-05-27 16:57:29,105 - main - INFO - === Starting Telegram Authentication ===
2025-05-27 16:57:29,112 - main - INFO - ********************************************************************************
2025-05-27 16:57:29,112 - main - DEBUG - Request headers:
2025-05-27 16:57:29,113 - main - DEBUG -   host: localhost:8000
2025-05-27 16:57:29,113 - main - DEBUG -   user-agent: curl/8.12.1
2025-05-27 16:57:29,113 - main - DEBUG -   accept: */*
2025-05-27 16:57:29,113 - main - DEBUG - Query parameters:
2025-05-27 16:57:29,115 - main - DEBUG - Raw init_data (repr): ''
2025-05-27 16:57:29,115 - main - ERROR - No init_data parameter provided in request
2025-05-27 16:57:29,115 - main - ERROR - Authentication failed with HTTPException
2025-05-27 16:57:29,117 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-27 16:57:29,119 - main - INFO - [676fa4aa-9dd8-4656-a505-0e9a829c5779] Response status: 400 - Completed in 0.0137s
2025-05-27 16:59:05,423 - main - INFO - [a68eabb7-7234-4b0b-a6bb-1616a796f279] Request from 127.0.0.1:53792 - POST /auth/telegram
2025-05-27 16:59:05,423 - main - INFO - [a68eabb7-7234-4b0b-a6bb-1616a796f279] Request body: init_data=user%3D%257B%2522id%2522%253A1%257D%5E%26hash%3Dtest
2025-05-27 16:59:05,423 - main - INFO - 

********************************************************************************
2025-05-27 16:59:05,430 - main - INFO - === Starting Telegram Authentication ===
2025-05-27 16:59:05,430 - main - INFO - ********************************************************************************
2025-05-27 16:59:05,430 - main - DEBUG - Request headers:
2025-05-27 16:59:05,430 - main - DEBUG -   host: localhost:8000
2025-05-27 16:59:05,433 - main - DEBUG -   user-agent: curl/8.12.1
2025-05-27 16:59:05,434 - main - DEBUG -   accept: */*
2025-05-27 16:59:05,434 - main - DEBUG -   content-length: 62
2025-05-27 16:59:05,434 - main - DEBUG -   content-type: application/x-www-form-urlencoded
2025-05-27 16:59:05,434 - main - DEBUG - Query parameters:
2025-05-27 16:59:05,434 - main - DEBUG - Raw init_data (repr): ''
2025-05-27 16:59:05,434 - main - ERROR - No init_data parameter provided in request
2025-05-27 16:59:05,434 - main - ERROR - Authentication failed with HTTPException
2025-05-27 16:59:05,440 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-27 16:59:05,441 - main - INFO - [a68eabb7-7234-4b0b-a6bb-1616a796f279] Response status: 400 - Completed in 0.0174s
2025-05-30 12:50:39,615 - main - INFO - ================================================================================
2025-05-30 12:50:39,615 - main - INFO - Starting Time Banking API
2025-05-30 12:50:39,615 - main - INFO - ================================================================================
2025-05-30 12:50:39,615 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 13:04:39,680 - main - INFO - ================================================================================
2025-05-30 13:04:39,680 - main - INFO - Starting Time Banking API
2025-05-30 13:04:39,680 - main - INFO - ================================================================================
2025-05-30 13:04:39,680 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 13:27:56,616 - main - INFO - ================================================================================
2025-05-30 13:27:56,616 - main - INFO - Starting Time Banking API
2025-05-30 13:27:56,616 - main - INFO - ================================================================================
2025-05-30 13:27:56,616 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 13:47:12,019 - main - INFO - ================================================================================
2025-05-30 13:47:12,019 - main - INFO - Starting Time Banking API
2025-05-30 13:47:12,020 - main - INFO - ================================================================================
2025-05-30 13:47:12,020 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 13:56:47,580 - main - INFO - ================================================================================
2025-05-30 13:56:47,580 - main - INFO - Starting Time Banking API
2025-05-30 13:56:47,580 - main - INFO - ================================================================================
2025-05-30 13:56:47,580 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:01:47,529 - main - INFO - ================================================================================
2025-05-30 14:01:47,530 - main - INFO - Starting Time Banking API
2025-05-30 14:01:47,530 - main - INFO - ================================================================================
2025-05-30 14:01:47,530 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:06:53,063 - main - INFO - [3e746a59-f860-43b2-9af7-18e75601028d] Request from 127.0.0.1:52154 - POST /debug/auth
2025-05-30 14:06:53,063 - main - INFO - [3e746a59-f860-43b2-9af7-18e75601028d] Request body: {"telegram_id": 12345, "username": "test_user", "create_test_user": true}
2025-05-30 14:16:34,471 - main - INFO - [3e746a59-f860-43b2-9af7-18e75601028d] Response status: 400 - Completed in 581.4076s
2025-05-30 14:16:44,607 - main - INFO - [443cf24d-37a3-421f-9a86-f7772bd7529d] Request from 127.0.0.1:60922 - POST /debug/auth
2025-05-30 14:16:44,611 - main - INFO - [443cf24d-37a3-421f-9a86-f7772bd7529d] Request body: {"telegram_id": 12345, "username": "test_user", "create_test_user": true}
2025-05-30 14:21:30,570 - main - INFO - ================================================================================
2025-05-30 14:21:30,570 - main - INFO - Starting Time Banking API
2025-05-30 14:21:30,571 - main - INFO - ================================================================================
2025-05-30 14:21:30,571 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:40:32,017 - main - INFO - [1729be08-acb3-4b00-9c56-5d0b21e44dfb] Request from 77.91.101.132:0 - GET /
2025-05-30 14:40:32,021 - main - INFO - [1729be08-acb3-4b00-9c56-5d0b21e44dfb] Response status: 200 - Completed in 0.0041s
2025-05-30 14:40:32,549 - main - INFO - [46e4d5bb-236f-4b5d-b19e-bf9f3ba67a79] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:32,549 - main - INFO - [46e4d5bb-236f-4b5d-b19e-bf9f3ba67a79] Query params: {'init_data': 'auth_date=1748605232&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605232'}
2025-05-30 14:40:32,549 - main - INFO - 

********************************************************************************
2025-05-30 14:40:32,549 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:32,549 - main - INFO - ********************************************************************************
2025-05-30 14:40:32,556 - main - DEBUG - Request headers:
2025-05-30 14:40:32,556 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:32,558 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:32,558 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:32,558 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:32,558 - main - DEBUG -   accept: */*
2025-05-30 14:40:32,558 - main - DEBUG -   content-length: 0
2025-05-30 14:40:32,558 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:32,561 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:32,561 - main - DEBUG -   connection: close
2025-05-30 14:40:32,561 - main - DEBUG - Query parameters:
2025-05-30 14:40:32,561 - main - DEBUG -   init_data: auth_date=1748605232&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605232
2025-05-30 14:40:32,563 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605232&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605232'
2025-05-30 14:40:32,563 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:32,563 - main - DEBUG -   auth_date: 1748605232
2025-05-30 14:40:32,563 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:32,566 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:32,566 - main - DEBUG -   test_mode: true
2025-05-30 14:40:32,567 - main - DEBUG -   hash: test_hash_1748605232
2025-05-30 14:40:32,567 - main - DEBUG - Extracted hash value: test_hash_1748605232
2025-05-30 14:40:32,567 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:32,567 - auth - DEBUG - 
==================================================
2025-05-30 14:40:32,567 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:32,567 - auth - DEBUG - ==================================================
2025-05-30 14:40:32,567 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:32,567 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:32,571 - auth - DEBUG - init_data (repr): 'auth_date=1748605232&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605232'
2025-05-30 14:40:32,571 - auth - DEBUG - received_hash: test_hash_1748605232
2025-05-30 14:40:32,573 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:32,574 - main - INFO - Hash verification successful
2025-05-30 14:40:32,575 - main - INFO - Parsing user data...
2025-05-30 14:40:32,575 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:32,576 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:32,576 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:40:32,577 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:40:32,578 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:40:32,581 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:40:32,581 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:40:32,582 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:40:32,596 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:40:32.583085)
2025-05-30 14:40:32,596 - main - INFO - JWT token created successfully
2025-05-30 14:40:32,603 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:32,603 - main - INFO - ********************************************************************************


2025-05-30 14:40:32,606 - main - INFO - [46e4d5bb-236f-4b5d-b19e-bf9f3ba67a79] Response status: 200 - Completed in 0.0570s
2025-05-30 14:40:33,088 - main - INFO - [c3bd18e3-bacd-423f-9b95-006605af24ea] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:33,090 - main - INFO - [c3bd18e3-bacd-423f-9b95-006605af24ea] Query params: {'init_data': 'auth_date=1748605232&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605232'}
2025-05-30 14:40:33,091 - main - INFO - 

********************************************************************************
2025-05-30 14:40:33,092 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:33,092 - main - INFO - ********************************************************************************
2025-05-30 14:40:33,092 - main - DEBUG - Request headers:
2025-05-30 14:40:33,095 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:33,096 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:33,096 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:33,097 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:33,098 - main - DEBUG -   accept: */*
2025-05-30 14:40:33,098 - main - DEBUG -   content-length: 0
2025-05-30 14:40:33,098 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:33,098 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:33,098 - main - DEBUG -   connection: close
2025-05-30 14:40:33,098 - main - DEBUG - Query parameters:
2025-05-30 14:40:33,098 - main - DEBUG -   init_data: auth_date=1748605232&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605232
2025-05-30 14:40:33,098 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605232&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605232'
2025-05-30 14:40:33,104 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:33,104 - main - DEBUG -   auth_date: 1748605232
2025-05-30 14:40:33,106 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:33,106 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:33,106 - main - DEBUG -   test_mode: true
2025-05-30 14:40:33,106 - main - DEBUG -   hash: test_hash_1748605232
2025-05-30 14:40:33,106 - main - DEBUG - Extracted hash value: test_hash_1748605232
2025-05-30 14:40:33,106 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:33,106 - auth - DEBUG - 
==================================================
2025-05-30 14:40:33,106 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:33,112 - auth - DEBUG - ==================================================
2025-05-30 14:40:33,113 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:33,113 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:33,114 - auth - DEBUG - init_data (repr): 'auth_date=1748605232&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605232'
2025-05-30 14:40:33,115 - auth - DEBUG - received_hash: test_hash_1748605232
2025-05-30 14:40:33,116 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:33,116 - main - INFO - Hash verification successful
2025-05-30 14:40:33,117 - main - INFO - Parsing user data...
2025-05-30 14:40:33,118 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:33,119 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:33,120 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:40:33,121 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:40:33,121 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:40:33,123 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:40:33,124 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:40:33,125 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:40:33,126 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:40:33.126591)
2025-05-30 14:40:33,126 - main - INFO - JWT token created successfully
2025-05-30 14:40:33,128 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:33,128 - main - INFO - ********************************************************************************


2025-05-30 14:40:33,128 - main - INFO - [c3bd18e3-bacd-423f-9b95-006605af24ea] Response status: 200 - Completed in 0.0378s
2025-05-30 14:40:34,801 - main - INFO - [18daf0e7-d862-4866-8c6c-22d55bd39017] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:40:34,811 - main - INFO - [18daf0e7-d862-4866-8c6c-22d55bd39017] Response status: 200 - Completed in 0.0086s
2025-05-30 14:40:35,301 - main - INFO - [2aa8f4fd-4fed-4ec0-804f-976678c4f126] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:35,302 - main - INFO - [2aa8f4fd-4fed-4ec0-804f-976678c4f126] Query params: {'init_data': 'auth_date=1748605234&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605234'}
2025-05-30 14:40:35,304 - main - INFO - 

********************************************************************************
2025-05-30 14:40:35,304 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:35,305 - main - INFO - ********************************************************************************
2025-05-30 14:40:35,306 - main - DEBUG - Request headers:
2025-05-30 14:40:35,306 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:35,306 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:35,307 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:35,307 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:35,309 - main - DEBUG -   accept: */*
2025-05-30 14:40:35,309 - main - DEBUG -   content-length: 0
2025-05-30 14:40:35,309 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:35,309 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:35,309 - main - DEBUG -   connection: close
2025-05-30 14:40:35,311 - main - DEBUG - Query parameters:
2025-05-30 14:40:35,311 - main - DEBUG -   init_data: auth_date=1748605234&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605234
2025-05-30 14:40:35,313 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605234&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605234'
2025-05-30 14:40:35,313 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:35,313 - main - DEBUG -   auth_date: 1748605234
2025-05-30 14:40:35,313 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:35,313 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:35,316 - main - DEBUG -   test_mode: true
2025-05-30 14:40:35,316 - main - DEBUG -   hash: test_hash_1748605234
2025-05-30 14:40:35,317 - main - DEBUG - Extracted hash value: test_hash_1748605234
2025-05-30 14:40:35,317 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:35,317 - auth - DEBUG - 
==================================================
2025-05-30 14:40:35,317 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:35,317 - auth - DEBUG - ==================================================
2025-05-30 14:40:35,317 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:35,317 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:35,317 - auth - DEBUG - init_data (repr): 'auth_date=1748605234&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605234'
2025-05-30 14:40:35,317 - auth - DEBUG - received_hash: test_hash_1748605234
2025-05-30 14:40:35,317 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:35,317 - main - INFO - Hash verification successful
2025-05-30 14:40:35,317 - main - INFO - Parsing user data...
2025-05-30 14:40:35,324 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:35,324 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:35,324 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:40:35,326 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:40:35,326 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:40:35,328 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:40:35,328 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:40:35,328 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:40:35,328 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:40:35.328631)
2025-05-30 14:40:35,328 - main - INFO - JWT token created successfully
2025-05-30 14:40:35,332 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:35,332 - main - INFO - ********************************************************************************


2025-05-30 14:40:35,332 - main - INFO - [2aa8f4fd-4fed-4ec0-804f-976678c4f126] Response status: 200 - Completed in 0.0292s
2025-05-30 14:40:35,803 - main - INFO - [87444ae3-71c8-4907-901b-8d1e131bd5a3] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:40:35,807 - main - INFO - [87444ae3-71c8-4907-901b-8d1e131bd5a3] Response status: 200 - Completed in 0.0029s
2025-05-30 14:40:36,576 - main - INFO - [a03b5e54-8ab5-4863-8a1c-1e65ef996ad6] Request from 77.91.101.132:0 - POST /listings
2025-05-30 14:40:36,577 - main - INFO - [a03b5e54-8ab5-4863-8a1c-1e65ef996ad6] Request body: {"listing_type": "request", "title": "Test Request", "description": "This is a test request created by automated tests", "hours": 1.0, "user_id": 1}
2025-05-30 14:40:36,578 - main - INFO - [a03b5e54-8ab5-4863-8a1c-1e65ef996ad6] Response status: 307 - Completed in 0.0005s
2025-05-30 14:40:39,193 - main - INFO - [f06155e6-f073-4cd0-b585-6a673a7a76e1] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:39,193 - main - INFO - [f06155e6-f073-4cd0-b585-6a673a7a76e1] Query params: {'init_data': 'auth_date=1748605238&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605238'}
2025-05-30 14:40:39,198 - main - INFO - 

********************************************************************************
2025-05-30 14:40:39,198 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:39,200 - main - INFO - ********************************************************************************
2025-05-30 14:40:39,200 - main - DEBUG - Request headers:
2025-05-30 14:40:39,201 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:39,202 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:39,202 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:39,202 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:39,202 - main - DEBUG -   accept: */*
2025-05-30 14:40:39,202 - main - DEBUG -   content-length: 0
2025-05-30 14:40:39,204 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:39,204 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:39,205 - main - DEBUG -   connection: close
2025-05-30 14:40:39,206 - main - DEBUG - Query parameters:
2025-05-30 14:40:39,207 - main - DEBUG -   init_data: auth_date=1748605238&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605238
2025-05-30 14:40:39,207 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605238&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605238'
2025-05-30 14:40:39,207 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:39,208 - main - DEBUG -   auth_date: 1748605238
2025-05-30 14:40:39,208 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:39,208 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:39,208 - main - DEBUG -   test_mode: true
2025-05-30 14:40:39,208 - main - DEBUG -   hash: test_hash_1748605238
2025-05-30 14:40:39,208 - main - DEBUG - Extracted hash value: test_hash_1748605238
2025-05-30 14:40:39,212 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:39,212 - auth - DEBUG - 
==================================================
2025-05-30 14:40:39,212 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:39,212 - auth - DEBUG - ==================================================
2025-05-30 14:40:39,212 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:39,215 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:39,215 - auth - DEBUG - init_data (repr): 'auth_date=1748605238&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605238'
2025-05-30 14:40:39,216 - auth - DEBUG - received_hash: test_hash_1748605238
2025-05-30 14:40:39,216 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:39,216 - main - INFO - Hash verification successful
2025-05-30 14:40:39,216 - main - INFO - Parsing user data...
2025-05-30 14:40:39,216 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:39,216 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:40:39,216 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:40:39,216 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:40:39,216 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:40:39,216 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:40:39,216 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:40:39,216 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:40:39,225 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:40:39.225087)
2025-05-30 14:40:39,226 - main - INFO - JWT token created successfully
2025-05-30 14:40:39,227 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:39,227 - main - INFO - ********************************************************************************


2025-05-30 14:40:39,229 - main - INFO - [f06155e6-f073-4cd0-b585-6a673a7a76e1] Response status: 200 - Completed in 0.0338s
2025-05-30 14:40:40,004 - main - INFO - [df832923-8794-430c-99b5-b49c4b323d7a] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:40:40,005 - main - INFO - [df832923-8794-430c-99b5-b49c4b323d7a] Response status: 307 - Completed in 0.0000s
2025-05-30 14:40:42,919 - main - INFO - [bdd24275-df6e-4798-bcad-4a8a123a49bc] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:42,920 - main - INFO - [bdd24275-df6e-4798-bcad-4a8a123a49bc] Query params: {'init_data': 'auth_date=1748605242&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22creator_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605242'}
2025-05-30 14:40:42,922 - main - INFO - 

********************************************************************************
2025-05-30 14:40:42,922 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:42,923 - main - INFO - ********************************************************************************
2025-05-30 14:40:42,923 - main - DEBUG - Request headers:
2025-05-30 14:40:42,924 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:42,924 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:42,927 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:42,927 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:42,927 - main - DEBUG -   accept: */*
2025-05-30 14:40:42,927 - main - DEBUG -   content-length: 0
2025-05-30 14:40:42,927 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:42,927 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:42,931 - main - DEBUG -   connection: close
2025-05-30 14:40:42,932 - main - DEBUG - Query parameters:
2025-05-30 14:40:42,932 - main - DEBUG -   init_data: auth_date=1748605242&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22creator_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605242
2025-05-30 14:40:42,933 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605242&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "creator_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605242'
2025-05-30 14:40:42,934 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:42,934 - main - DEBUG -   auth_date: 1748605242
2025-05-30 14:40:42,934 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:42,934 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "creator_user", "language_code": "ru"}
2025-05-30 14:40:42,935 - main - DEBUG -   test_mode: true
2025-05-30 14:40:42,936 - main - DEBUG -   hash: test_hash_1748605242
2025-05-30 14:40:42,937 - main - DEBUG - Extracted hash value: test_hash_1748605242
2025-05-30 14:40:42,937 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:42,938 - auth - DEBUG - 
==================================================
2025-05-30 14:40:42,938 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:42,938 - auth - DEBUG - ==================================================
2025-05-30 14:40:42,938 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:42,938 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:42,941 - auth - DEBUG - init_data (repr): 'auth_date=1748605242&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "creator_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605242'
2025-05-30 14:40:42,941 - auth - DEBUG - received_hash: test_hash_1748605242
2025-05-30 14:40:42,941 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:42,941 - main - INFO - Hash verification successful
2025-05-30 14:40:42,941 - main - INFO - Parsing user data...
2025-05-30 14:40:42,941 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "creator_user", "language_code": "ru"}
2025-05-30 14:40:42,944 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "creator_user", "language_code": "ru"}
2025-05-30 14:40:42,946 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'creator_user', 'language_code': 'ru'}
2025-05-30 14:40:42,946 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:40:42,947 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:40:42,947 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:40:42,949 - main - INFO - Updated username from test_user to: creator_user
2025-05-30 14:40:42,958 - main - INFO - Creating JWT token for user: creator_user
2025-05-30 14:40:42,958 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'creator_user'}
2025-05-30 14:40:42,962 - auth - DEBUG - JWT created for creator_user (exp 2025-05-31 11:40:42.962695)
2025-05-30 14:40:42,963 - main - INFO - JWT token created successfully
2025-05-30 14:40:42,963 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:42,963 - main - INFO - ********************************************************************************


2025-05-30 14:40:42,965 - main - INFO - [bdd24275-df6e-4798-bcad-4a8a123a49bc] Response status: 200 - Completed in 0.0448s
2025-05-30 14:40:43,536 - main - INFO - [65e9765e-e686-441e-946c-5abdb7708645] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:43,537 - main - INFO - [65e9765e-e686-441e-946c-5abdb7708645] Query params: {'init_data': 'auth_date=1748605243&query_id=test_query_id&user=%7B%22id%22%3A%2054321%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22worker_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605243'}
2025-05-30 14:40:43,539 - main - INFO - 

********************************************************************************
2025-05-30 14:40:43,540 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:43,540 - main - INFO - ********************************************************************************
2025-05-30 14:40:43,540 - main - DEBUG - Request headers:
2025-05-30 14:40:43,541 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:43,542 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:43,542 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:43,543 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:43,544 - main - DEBUG -   accept: */*
2025-05-30 14:40:43,544 - main - DEBUG -   content-length: 0
2025-05-30 14:40:43,544 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:43,545 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:43,546 - main - DEBUG -   connection: close
2025-05-30 14:40:43,546 - main - DEBUG - Query parameters:
2025-05-30 14:40:43,546 - main - DEBUG -   init_data: auth_date=1748605243&query_id=test_query_id&user=%7B%22id%22%3A%2054321%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22worker_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605243
2025-05-30 14:40:43,548 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605243&query_id=test_query_id&user={"id": 54321, "first_name": "Test", "username": "worker_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605243'
2025-05-30 14:40:43,549 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:43,549 - main - DEBUG -   auth_date: 1748605243
2025-05-30 14:40:43,550 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:43,550 - main - DEBUG -   user: {"id": 54321, "first_name": "Test", "username": "worker_user", "language_code": "ru"}
2025-05-30 14:40:43,550 - main - DEBUG -   test_mode: true
2025-05-30 14:40:43,550 - main - DEBUG -   hash: test_hash_1748605243
2025-05-30 14:40:43,550 - main - DEBUG - Extracted hash value: test_hash_1748605243
2025-05-30 14:40:43,552 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:43,552 - auth - DEBUG - 
==================================================
2025-05-30 14:40:43,552 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:43,552 - auth - DEBUG - ==================================================
2025-05-30 14:40:43,552 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:43,555 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:43,556 - auth - DEBUG - init_data (repr): 'auth_date=1748605243&query_id=test_query_id&user={"id": 54321, "first_name": "Test", "username": "worker_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605243'
2025-05-30 14:40:43,557 - auth - DEBUG - received_hash: test_hash_1748605243
2025-05-30 14:40:43,557 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:43,557 - main - INFO - Hash verification successful
2025-05-30 14:40:43,557 - main - INFO - Parsing user data...
2025-05-30 14:40:43,557 - main - DEBUG - Raw user data: {"id": 54321, "first_name": "Test", "username": "worker_user", "language_code": "ru"}
2025-05-30 14:40:43,557 - main - DEBUG - URL-decoded user data: {"id": 54321, "first_name": "Test", "username": "worker_user", "language_code": "ru"}
2025-05-30 14:40:43,557 - main - DEBUG - Parsed user_info: {'id': 54321, 'first_name': 'Test', 'username': 'worker_user', 'language_code': 'ru'}
2025-05-30 14:40:43,557 - main - DEBUG - Converted telegram_id to int: 54321 (type: <class 'int'>)
2025-05-30 14:40:43,561 - main - INFO - Looking up user with telegram_id: 54321
2025-05-30 14:40:43,563 - main - INFO - Creating new user with telegram_id: 54321
2025-05-30 14:40:43,563 - main - DEBUG - Using username: worker_user
2025-05-30 14:40:43,573 - main - INFO - New user created: worker_user (ID: 4, Telegram ID: 54321)
2025-05-30 14:40:43,576 - main - INFO - Creating JWT token for user: worker_user
2025-05-30 14:40:43,577 - main - DEBUG - Token data: {'sub': '4', 'telegram_id': '54321', 'username': 'worker_user'}
2025-05-30 14:40:43,577 - auth - DEBUG - JWT created for worker_user (exp 2025-05-31 11:40:43.577211)
2025-05-30 14:40:43,579 - main - INFO - JWT token created successfully
2025-05-30 14:40:43,579 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:43,579 - main - INFO - ********************************************************************************


2025-05-30 14:40:43,579 - main - INFO - [65e9765e-e686-441e-946c-5abdb7708645] Response status: 200 - Completed in 0.0410s
2025-05-30 14:40:44,036 - main - INFO - [ce3dfc87-5762-47b8-8ebb-f209fcb289ee] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:40:44,040 - main - INFO - [ce3dfc87-5762-47b8-8ebb-f209fcb289ee] Response status: 200 - Completed in 0.0027s
2025-05-30 14:40:44,781 - main - INFO - [ad019dea-55c6-4c82-953d-dcb8e94a6731] Request from 77.91.101.132:0 - POST /listings
2025-05-30 14:40:44,782 - main - INFO - [ad019dea-55c6-4c82-953d-dcb8e94a6731] Request body: {"listing_type": "request", "title": "Workflow Test Request", "description": "This is a test request for workflow testing", "hours": 1.0, "user_id": 1}
2025-05-30 14:40:44,783 - main - INFO - [ad019dea-55c6-4c82-953d-dcb8e94a6731] Response status: 307 - Completed in 0.0000s
2025-05-30 14:40:47,352 - main - INFO - [f1566754-0ddc-469e-a153-a227179c9031] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:47,353 - main - INFO - [f1566754-0ddc-469e-a153-a227179c9031] Query params: {'init_data': 'auth_date=1748605246&query_id=test_query_id&user=%7B%22id%22%3A%2011111%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22user_one%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605246'}
2025-05-30 14:40:47,355 - main - INFO - 

********************************************************************************
2025-05-30 14:40:47,355 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:47,356 - main - INFO - ********************************************************************************
2025-05-30 14:40:47,356 - main - DEBUG - Request headers:
2025-05-30 14:40:47,357 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:47,358 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:47,358 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:47,359 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:47,359 - main - DEBUG -   accept: */*
2025-05-30 14:40:47,359 - main - DEBUG -   content-length: 0
2025-05-30 14:40:47,361 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:47,361 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:47,361 - main - DEBUG -   connection: close
2025-05-30 14:40:47,361 - main - DEBUG - Query parameters:
2025-05-30 14:40:47,361 - main - DEBUG -   init_data: auth_date=1748605246&query_id=test_query_id&user=%7B%22id%22%3A%2011111%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22user_one%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605246
2025-05-30 14:40:47,363 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605246&query_id=test_query_id&user={"id": 11111, "first_name": "Test", "username": "user_one", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605246'
2025-05-30 14:40:47,363 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:47,364 - main - DEBUG -   auth_date: 1748605246
2025-05-30 14:40:47,365 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:47,366 - main - DEBUG -   user: {"id": 11111, "first_name": "Test", "username": "user_one", "language_code": "ru"}
2025-05-30 14:40:47,366 - main - DEBUG -   test_mode: true
2025-05-30 14:40:47,366 - main - DEBUG -   hash: test_hash_1748605246
2025-05-30 14:40:47,366 - main - DEBUG - Extracted hash value: test_hash_1748605246
2025-05-30 14:40:47,366 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:47,369 - auth - DEBUG - 
==================================================
2025-05-30 14:40:47,369 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:47,369 - auth - DEBUG - ==================================================
2025-05-30 14:40:47,369 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:47,369 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:47,369 - auth - DEBUG - init_data (repr): 'auth_date=1748605246&query_id=test_query_id&user={"id": 11111, "first_name": "Test", "username": "user_one", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605246'
2025-05-30 14:40:47,369 - auth - DEBUG - received_hash: test_hash_1748605246
2025-05-30 14:40:47,369 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:47,369 - main - INFO - Hash verification successful
2025-05-30 14:40:47,369 - main - INFO - Parsing user data...
2025-05-30 14:40:47,369 - main - DEBUG - Raw user data: {"id": 11111, "first_name": "Test", "username": "user_one", "language_code": "ru"}
2025-05-30 14:40:47,375 - main - DEBUG - URL-decoded user data: {"id": 11111, "first_name": "Test", "username": "user_one", "language_code": "ru"}
2025-05-30 14:40:47,376 - main - DEBUG - Parsed user_info: {'id': 11111, 'first_name': 'Test', 'username': 'user_one', 'language_code': 'ru'}
2025-05-30 14:40:47,377 - main - DEBUG - Converted telegram_id to int: 11111 (type: <class 'int'>)
2025-05-30 14:40:47,377 - main - INFO - Looking up user with telegram_id: 11111
2025-05-30 14:40:47,380 - main - INFO - Creating new user with telegram_id: 11111
2025-05-30 14:40:47,380 - main - DEBUG - Using username: user_one
2025-05-30 14:40:47,389 - main - INFO - New user created: user_one (ID: 5, Telegram ID: 11111)
2025-05-30 14:40:47,389 - main - INFO - Creating JWT token for user: user_one
2025-05-30 14:40:47,389 - main - DEBUG - Token data: {'sub': '5', 'telegram_id': '11111', 'username': 'user_one'}
2025-05-30 14:40:47,389 - auth - DEBUG - JWT created for user_one (exp 2025-05-31 11:40:47.389405)
2025-05-30 14:40:47,389 - main - INFO - JWT token created successfully
2025-05-30 14:40:47,394 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:47,395 - main - INFO - ********************************************************************************


2025-05-30 14:40:47,396 - main - INFO - [f1566754-0ddc-469e-a153-a227179c9031] Response status: 200 - Completed in 0.0422s
2025-05-30 14:40:47,922 - main - INFO - [f50d0e98-f15d-42ca-b712-477e19545c0f] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:40:47,923 - main - INFO - [f50d0e98-f15d-42ca-b712-477e19545c0f] Query params: {'init_data': 'auth_date=1748605247&query_id=test_query_id&user=%7B%22id%22%3A%2022222%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22user_two%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605247'}
2025-05-30 14:40:47,925 - main - INFO - 

********************************************************************************
2025-05-30 14:40:47,925 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:40:47,926 - main - INFO - ********************************************************************************
2025-05-30 14:40:47,926 - main - DEBUG - Request headers:
2025-05-30 14:40:47,927 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:40:47,927 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:40:47,928 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:40:47,929 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:40:47,930 - main - DEBUG -   accept: */*
2025-05-30 14:40:47,930 - main - DEBUG -   content-length: 0
2025-05-30 14:40:47,930 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:40:47,930 - main - DEBUG -   host: localhost:8000
2025-05-30 14:40:47,930 - main - DEBUG -   connection: close
2025-05-30 14:40:47,932 - main - DEBUG - Query parameters:
2025-05-30 14:40:47,932 - main - DEBUG -   init_data: auth_date=1748605247&query_id=test_query_id&user=%7B%22id%22%3A%2022222%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22user_two%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605247
2025-05-30 14:40:47,934 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605247&query_id=test_query_id&user={"id": 22222, "first_name": "Test", "username": "user_two", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605247'
2025-05-30 14:40:47,934 - main - DEBUG - Parsed data parameters:
2025-05-30 14:40:47,935 - main - DEBUG -   auth_date: 1748605247
2025-05-30 14:40:47,936 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:40:47,936 - main - DEBUG -   user: {"id": 22222, "first_name": "Test", "username": "user_two", "language_code": "ru"}
2025-05-30 14:40:47,937 - main - DEBUG -   test_mode: true
2025-05-30 14:40:47,938 - main - DEBUG -   hash: test_hash_1748605247
2025-05-30 14:40:47,938 - main - DEBUG - Extracted hash value: test_hash_1748605247
2025-05-30 14:40:47,938 - main - INFO - Verifying Telegram hash...
2025-05-30 14:40:47,940 - auth - DEBUG - 
==================================================
2025-05-30 14:40:47,940 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:40:47,940 - auth - DEBUG - ==================================================
2025-05-30 14:40:47,940 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:40:47,940 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:40:47,943 - auth - DEBUG - init_data (repr): 'auth_date=1748605247&query_id=test_query_id&user={"id": 22222, "first_name": "Test", "username": "user_two", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605247'
2025-05-30 14:40:47,944 - auth - DEBUG - received_hash: test_hash_1748605247
2025-05-30 14:40:47,944 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:40:47,944 - main - INFO - Hash verification successful
2025-05-30 14:40:47,945 - main - INFO - Parsing user data...
2025-05-30 14:40:47,946 - main - DEBUG - Raw user data: {"id": 22222, "first_name": "Test", "username": "user_two", "language_code": "ru"}
2025-05-30 14:40:47,947 - main - DEBUG - URL-decoded user data: {"id": 22222, "first_name": "Test", "username": "user_two", "language_code": "ru"}
2025-05-30 14:40:47,947 - main - DEBUG - Parsed user_info: {'id': 22222, 'first_name': 'Test', 'username': 'user_two', 'language_code': 'ru'}
2025-05-30 14:40:47,947 - main - DEBUG - Converted telegram_id to int: 22222 (type: <class 'int'>)
2025-05-30 14:40:47,949 - main - INFO - Looking up user with telegram_id: 22222
2025-05-30 14:40:47,949 - main - INFO - Creating new user with telegram_id: 22222
2025-05-30 14:40:47,949 - main - DEBUG - Using username: user_two
2025-05-30 14:40:47,957 - main - INFO - New user created: user_two (ID: 6, Telegram ID: 22222)
2025-05-30 14:40:47,957 - main - INFO - Creating JWT token for user: user_two
2025-05-30 14:40:47,957 - main - DEBUG - Token data: {'sub': '6', 'telegram_id': '22222', 'username': 'user_two'}
2025-05-30 14:40:47,957 - auth - DEBUG - JWT created for user_two (exp 2025-05-31 11:40:47.957297)
2025-05-30 14:40:47,962 - main - INFO - JWT token created successfully
2025-05-30 14:40:47,962 - main - INFO - === Authentication Successful ===
2025-05-30 14:40:47,962 - main - INFO - ********************************************************************************


2025-05-30 14:40:47,965 - main - INFO - [f50d0e98-f15d-42ca-b712-477e19545c0f] Response status: 200 - Completed in 0.0403s
2025-05-30 14:40:48,420 - main - INFO - [6ea84b71-0bc0-4a28-ac0e-11fae8015a50] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:40:48,423 - main - INFO - [6ea84b71-0bc0-4a28-ac0e-11fae8015a50] Response status: 200 - Completed in 0.0022s
2025-05-30 14:40:48,903 - main - INFO - [b0cac1d6-1c71-4b6a-8e2f-fc8a439f66d6] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:40:48,907 - main - INFO - [b0cac1d6-1c71-4b6a-8e2f-fc8a439f66d6] Response status: 200 - Completed in 0.0027s
2025-05-30 14:40:50,451 - main - INFO - [fa570d89-cb2f-40d6-9846-66700ae562d6] Request from 77.91.101.132:0 - POST /friends/request
2025-05-30 14:40:50,453 - main - INFO - [fa570d89-cb2f-40d6-9846-66700ae562d6] Request body: {"friend_id": 6}
2025-05-30 14:41:20,457 - main - INFO - [fa570d89-cb2f-40d6-9846-66700ae562d6] Response status: 400 - Completed in 30.0031s
2025-05-30 14:41:21,176 - main - INFO - [ff8ff208-b0a2-401f-b8ce-6571d1ec1a7b] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:41:21,185 - main - INFO - [ff8ff208-b0a2-401f-b8ce-6571d1ec1a7b] Query params: {'init_data': 'auth_date=1748605280&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605280'}
2025-05-30 14:41:21,187 - main - INFO - 

********************************************************************************
2025-05-30 14:41:21,187 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:41:21,187 - main - INFO - ********************************************************************************
2025-05-30 14:41:21,187 - main - DEBUG - Request headers:
2025-05-30 14:41:21,187 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:41:21,192 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:41:21,192 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:41:21,192 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:41:21,192 - main - DEBUG -   accept: */*
2025-05-30 14:41:21,192 - main - DEBUG -   content-length: 0
2025-05-30 14:41:21,194 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:41:21,195 - main - DEBUG -   host: localhost:8000
2025-05-30 14:41:21,196 - main - DEBUG -   connection: close
2025-05-30 14:41:21,196 - main - DEBUG - Query parameters:
2025-05-30 14:41:21,197 - main - DEBUG -   init_data: auth_date=1748605280&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605280
2025-05-30 14:41:21,197 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605280&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605280'
2025-05-30 14:41:21,197 - main - DEBUG - Parsed data parameters:
2025-05-30 14:41:21,197 - main - DEBUG -   auth_date: 1748605280
2025-05-30 14:41:21,197 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:41:21,200 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:21,201 - main - DEBUG -   test_mode: true
2025-05-30 14:41:21,201 - main - DEBUG -   hash: test_hash_1748605280
2025-05-30 14:41:21,201 - main - DEBUG - Extracted hash value: test_hash_1748605280
2025-05-30 14:41:21,201 - main - INFO - Verifying Telegram hash...
2025-05-30 14:41:21,201 - auth - DEBUG - 
==================================================
2025-05-30 14:41:21,205 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:41:21,205 - auth - DEBUG - ==================================================
2025-05-30 14:41:21,206 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:41:21,207 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:41:21,207 - auth - DEBUG - init_data (repr): 'auth_date=1748605280&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605280'
2025-05-30 14:41:21,207 - auth - DEBUG - received_hash: test_hash_1748605280
2025-05-30 14:41:21,209 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:41:21,209 - main - INFO - Hash verification successful
2025-05-30 14:41:21,210 - main - INFO - Parsing user data...
2025-05-30 14:41:21,210 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:21,211 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:21,211 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:41:21,211 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:41:21,211 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:41:21,215 - main - INFO - Found existing user: creator_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:41:21,215 - main - INFO - Updated username from creator_user to: test_user
2025-05-30 14:41:21,217 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:41:21,225 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:41:21,225 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:41:21.225672)
2025-05-30 14:41:21,226 - main - INFO - JWT token created successfully
2025-05-30 14:41:21,227 - main - INFO - === Authentication Successful ===
2025-05-30 14:41:21,227 - main - INFO - ********************************************************************************


2025-05-30 14:41:21,227 - main - INFO - [ff8ff208-b0a2-401f-b8ce-6571d1ec1a7b] Response status: 200 - Completed in 0.0407s
2025-05-30 14:41:21,856 - main - INFO - [72d511cb-5948-445e-ae11-b9b5acce1c40] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:41:21,856 - main - INFO - [72d511cb-5948-445e-ae11-b9b5acce1c40] Response status: 200 - Completed in 0.0000s
2025-05-30 14:41:22,352 - main - INFO - [10ac7821-07c9-4f98-9121-dac5776bd222] Request from 77.91.101.132:0 - GET /transactions/1
2025-05-30 14:41:22,362 - main - INFO - [10ac7821-07c9-4f98-9121-dac5776bd222] Response status: 200 - Completed in 0.0091s
2025-05-30 14:41:22,889 - main - INFO - [752e9fed-e4fa-4ee6-811c-c386fdc2a73a] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:41:22,890 - main - INFO - [752e9fed-e4fa-4ee6-811c-c386fdc2a73a] Query params: {'init_data': 'auth_date=1748605282&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605282'}
2025-05-30 14:41:22,891 - main - INFO - 

********************************************************************************
2025-05-30 14:41:22,892 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:41:22,892 - main - INFO - ********************************************************************************
2025-05-30 14:41:22,893 - main - DEBUG - Request headers:
2025-05-30 14:41:22,894 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:41:22,894 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:41:22,895 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:41:22,896 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:41:22,896 - main - DEBUG -   accept: */*
2025-05-30 14:41:22,896 - main - DEBUG -   content-length: 0
2025-05-30 14:41:22,896 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:41:22,896 - main - DEBUG -   host: localhost:8000
2025-05-30 14:41:22,898 - main - DEBUG -   connection: close
2025-05-30 14:41:22,898 - main - DEBUG - Query parameters:
2025-05-30 14:41:22,898 - main - DEBUG -   init_data: auth_date=1748605282&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605282
2025-05-30 14:41:22,900 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605282&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605282'
2025-05-30 14:41:22,900 - main - DEBUG - Parsed data parameters:
2025-05-30 14:41:22,900 - main - DEBUG -   auth_date: 1748605282
2025-05-30 14:41:22,900 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:41:22,900 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:22,900 - main - DEBUG -   test_mode: true
2025-05-30 14:41:22,900 - main - DEBUG -   hash: test_hash_1748605282
2025-05-30 14:41:22,900 - main - DEBUG - Extracted hash value: test_hash_1748605282
2025-05-30 14:41:22,905 - main - INFO - Verifying Telegram hash...
2025-05-30 14:41:22,905 - auth - DEBUG - 
==================================================
2025-05-30 14:41:22,906 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:41:22,906 - auth - DEBUG - ==================================================
2025-05-30 14:41:22,906 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:41:22,906 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:41:22,906 - auth - DEBUG - init_data (repr): 'auth_date=1748605282&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605282'
2025-05-30 14:41:22,906 - auth - DEBUG - received_hash: test_hash_1748605282
2025-05-30 14:41:22,910 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:41:22,910 - main - INFO - Hash verification successful
2025-05-30 14:41:22,911 - main - INFO - Parsing user data...
2025-05-30 14:41:22,911 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:22,911 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:22,911 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:41:22,911 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:41:22,911 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:41:22,915 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:41:22,915 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:41:22,915 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:41:22,915 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:41:22.915956)
2025-05-30 14:41:22,915 - main - INFO - JWT token created successfully
2025-05-30 14:41:22,915 - main - INFO - === Authentication Successful ===
2025-05-30 14:41:22,915 - main - INFO - ********************************************************************************


2025-05-30 14:41:22,915 - main - INFO - [752e9fed-e4fa-4ee6-811c-c386fdc2a73a] Response status: 200 - Completed in 0.0251s
2025-05-30 14:41:23,437 - main - INFO - [cd04558e-516a-4e4c-8257-06071d6fbfc9] Request from 77.91.101.132:0 - GET /users/search
2025-05-30 14:41:23,437 - main - INFO - [cd04558e-516a-4e4c-8257-06071d6fbfc9] Query params: {'username': 'user'}
2025-05-30 14:41:23,445 - main - INFO - [cd04558e-516a-4e4c-8257-06071d6fbfc9] Response status: 200 - Completed in 0.0088s
2025-05-30 14:41:23,985 - main - INFO - [897fba5b-d868-4046-8747-0b238d0423a6] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:41:23,986 - main - INFO - [897fba5b-d868-4046-8747-0b238d0423a6] Query params: {'init_data': 'auth_date=1748605283&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605283'}
2025-05-30 14:41:23,990 - main - INFO - 

********************************************************************************
2025-05-30 14:41:23,990 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:41:23,990 - main - INFO - ********************************************************************************
2025-05-30 14:41:23,992 - main - DEBUG - Request headers:
2025-05-30 14:41:23,992 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:41:23,992 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:41:23,994 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:41:23,994 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:41:23,995 - main - DEBUG -   accept: */*
2025-05-30 14:41:23,995 - main - DEBUG -   content-length: 0
2025-05-30 14:41:23,995 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:41:23,995 - main - DEBUG -   host: localhost:8000
2025-05-30 14:41:23,995 - main - DEBUG -   connection: close
2025-05-30 14:41:23,995 - main - DEBUG - Query parameters:
2025-05-30 14:41:23,995 - main - DEBUG -   init_data: auth_date=1748605283&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605283
2025-05-30 14:41:23,995 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605283&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605283'
2025-05-30 14:41:23,995 - main - DEBUG - Parsed data parameters:
2025-05-30 14:41:23,995 - main - DEBUG -   auth_date: 1748605283
2025-05-30 14:41:23,995 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:41:24,004 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:24,005 - main - DEBUG -   test_mode: true
2025-05-30 14:41:24,006 - main - DEBUG -   hash: test_hash_1748605283
2025-05-30 14:41:24,006 - main - DEBUG - Extracted hash value: test_hash_1748605283
2025-05-30 14:41:24,006 - main - INFO - Verifying Telegram hash...
2025-05-30 14:41:24,006 - auth - DEBUG - 
==================================================
2025-05-30 14:41:24,006 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:41:24,006 - auth - DEBUG - ==================================================
2025-05-30 14:41:24,006 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:41:24,006 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:41:24,006 - auth - DEBUG - init_data (repr): 'auth_date=1748605283&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605283'
2025-05-30 14:41:24,012 - auth - DEBUG - received_hash: test_hash_1748605283
2025-05-30 14:41:24,013 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:41:24,013 - main - INFO - Hash verification successful
2025-05-30 14:41:24,014 - main - INFO - Parsing user data...
2025-05-30 14:41:24,014 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:24,015 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:24,016 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:41:24,016 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:41:24,016 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:41:24,016 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:41:24,020 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:41:24,020 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:41:24,020 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:41:24.020953)
2025-05-30 14:41:24,020 - main - INFO - JWT token created successfully
2025-05-30 14:41:24,020 - main - INFO - === Authentication Successful ===
2025-05-30 14:41:24,020 - main - INFO - ********************************************************************************


2025-05-30 14:41:24,024 - main - INFO - [897fba5b-d868-4046-8747-0b238d0423a6] Response status: 200 - Completed in 0.0370s
2025-05-30 14:41:24,562 - main - INFO - [d3ca7603-ae27-427a-adc6-21811d537202] Request from 77.91.101.132:0 - GET /user/me
2025-05-30 14:41:24,566 - main - INFO - [d3ca7603-ae27-427a-adc6-21811d537202] Response status: 200 - Completed in 0.0032s
2025-05-30 14:41:25,073 - main - INFO - [26d5e13b-2167-44a9-a66a-4179868c386a] Request from 77.91.101.132:0 - GET /listings/user/1
2025-05-30 14:41:25,085 - main - INFO - [26d5e13b-2167-44a9-a66a-4179868c386a] Response status: 200 - Completed in 0.0107s
2025-05-30 14:41:25,550 - main - INFO - [e93313c8-cad5-485b-8326-1377186a4fa2] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:41:25,552 - main - INFO - [e93313c8-cad5-485b-8326-1377186a4fa2] Query params: {'init_data': 'auth_date=1748605285&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605285'}
2025-05-30 14:41:25,554 - main - INFO - 

********************************************************************************
2025-05-30 14:41:25,555 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:41:25,556 - main - INFO - ********************************************************************************
2025-05-30 14:41:25,557 - main - DEBUG - Request headers:
2025-05-30 14:41:25,558 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:41:25,558 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:41:25,558 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:41:25,558 - main - DEBUG -   accept-encoding: gzip, deflate
2025-05-30 14:41:25,558 - main - DEBUG -   accept: */*
2025-05-30 14:41:25,562 - main - DEBUG -   content-length: 0
2025-05-30 14:41:25,562 - main - DEBUG -   user-agent: python-requests/2.32.3
2025-05-30 14:41:25,564 - main - DEBUG -   host: localhost:8000
2025-05-30 14:41:25,565 - main - DEBUG -   connection: close
2025-05-30 14:41:25,565 - main - DEBUG - Query parameters:
2025-05-30 14:41:25,565 - main - DEBUG -   init_data: auth_date=1748605285&query_id=test_query_id&user=%7B%22id%22%3A%2012345%2C%20%22first_name%22%3A%20%22Test%22%2C%20%22username%22%3A%20%22test_user%22%2C%20%22language_code%22%3A%20%22ru%22%7D&test_mode=true&hash=test_hash_1748605285
2025-05-30 14:41:25,567 - main - DEBUG - Raw init_data (repr): 'auth_date=1748605285&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605285'
2025-05-30 14:41:25,567 - main - DEBUG - Parsed data parameters:
2025-05-30 14:41:25,567 - main - DEBUG -   auth_date: 1748605285
2025-05-30 14:41:25,570 - main - DEBUG -   query_id: test_query_id
2025-05-30 14:41:25,570 - main - DEBUG -   user: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:25,570 - main - DEBUG -   test_mode: true
2025-05-30 14:41:25,570 - main - DEBUG -   hash: test_hash_1748605285
2025-05-30 14:41:25,570 - main - DEBUG - Extracted hash value: test_hash_1748605285
2025-05-30 14:41:25,575 - main - INFO - Verifying Telegram hash...
2025-05-30 14:41:25,576 - auth - DEBUG - 
==================================================
2025-05-30 14:41:25,577 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:41:25,578 - auth - DEBUG - ==================================================
2025-05-30 14:41:25,579 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:41:25,580 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:41:25,580 - auth - DEBUG - init_data (repr): 'auth_date=1748605285&query_id=test_query_id&user={"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}&test_mode=true&hash=test_hash_1748605285'
2025-05-30 14:41:25,580 - auth - DEBUG - received_hash: test_hash_1748605285
2025-05-30 14:41:25,580 - auth - WARNING - TEST MODE detected - bypassing hash verification!
2025-05-30 14:41:25,580 - main - INFO - Hash verification successful
2025-05-30 14:41:25,585 - main - INFO - Parsing user data...
2025-05-30 14:41:25,586 - main - DEBUG - Raw user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:25,587 - main - DEBUG - URL-decoded user data: {"id": 12345, "first_name": "Test", "username": "test_user", "language_code": "ru"}
2025-05-30 14:41:25,588 - main - DEBUG - Parsed user_info: {'id': 12345, 'first_name': 'Test', 'username': 'test_user', 'language_code': 'ru'}
2025-05-30 14:41:25,588 - main - DEBUG - Converted telegram_id to int: 12345 (type: <class 'int'>)
2025-05-30 14:41:25,588 - main - INFO - Looking up user with telegram_id: 12345
2025-05-30 14:41:25,588 - main - INFO - Found existing user: test_user (ID: 1, Telegram ID: 12345)
2025-05-30 14:41:25,594 - main - INFO - Creating JWT token for user: test_user
2025-05-30 14:41:25,595 - main - DEBUG - Token data: {'sub': '1', 'telegram_id': '12345', 'username': 'test_user'}
2025-05-30 14:41:25,595 - auth - DEBUG - JWT created for test_user (exp 2025-05-31 11:41:25.595948)
2025-05-30 14:41:25,596 - main - INFO - JWT token created successfully
2025-05-30 14:41:25,598 - main - INFO - === Authentication Successful ===
2025-05-30 14:41:25,598 - main - INFO - ********************************************************************************


2025-05-30 14:41:25,598 - main - INFO - [e93313c8-cad5-485b-8326-1377186a4fa2] Response status: 200 - Completed in 0.0448s
2025-05-30 14:41:26,131 - main - INFO - [b8b98520-2214-4134-bad8-84be24d8be8e] Request from 77.91.101.132:0 - GET /diagnostics
2025-05-30 14:41:26,137 - main - INFO - [b8b98520-2214-4134-bad8-84be24d8be8e] Response status: 200 - Completed in 0.0049s
2025-05-30 14:45:03,516 - main - INFO - [4acca6a9-157f-4c08-8c9c-24f69c1b0817] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:45:03,518 - main - INFO - [4acca6a9-157f-4c08-8c9c-24f69c1b0817] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQAnEL3&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'}
2025-05-30 14:45:03,519 - main - INFO - [4acca6a9-157f-4c08-8c9c-24f69c1b0817] Request body: null
2025-05-30 14:45:03,521 - main - INFO - [52a0367f-9247-461a-9b9b-7f55a4da6444] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:45:03,521 - main - INFO - [52a0367f-9247-461a-9b9b-7f55a4da6444] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQAnEL3&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'}
2025-05-30 14:45:03,523 - main - INFO - [52a0367f-9247-461a-9b9b-7f55a4da6444] Request body: null
2025-05-30 14:45:03,524 - main - INFO - 

********************************************************************************
2025-05-30 14:45:03,525 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:45:03,525 - main - INFO - ********************************************************************************
2025-05-30 14:45:03,526 - main - DEBUG - Request headers:
2025-05-30 14:45:03,527 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:45:03,527 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,528 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:45:03,528 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:45:03,529 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:45:03,529 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:45:03,531 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:45:03,531 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:45:03,531 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:45:03,532 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:45:03,533 - main - DEBUG -   priority: u=1, i
2025-05-30 14:45:03,534 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,534 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,535 - main - DEBUG -   content-type: application/json
2025-05-30 14:45:03,535 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:45:03,536 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:45:03,537 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:45:03,537 - main - DEBUG -   content-length: 4
2025-05-30 14:45:03,538 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:45:03,539 - main - DEBUG -   host: localhost:8000
2025-05-30 14:45:03,539 - main - DEBUG -   connection: close
2025-05-30 14:45:03,541 - main - DEBUG - Query parameters:
2025-05-30 14:45:03,541 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQAnEL3&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,542 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'
2025-05-30 14:45:03,543 - main - DEBUG - Parsed data parameters:
2025-05-30 14:45:03,543 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQAnEL3
2025-05-30 14:45:03,544 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:45:03,545 - main - DEBUG -   auth_date: 1748605470
2025-05-30 14:45:03,545 - main - DEBUG -   signature: M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,546 - main - DEBUG -   hash: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,547 - main - DEBUG - Extracted hash value: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,548 - main - INFO - Verifying Telegram hash...
2025-05-30 14:45:03,548 - auth - DEBUG - 
==================================================
2025-05-30 14:45:03,549 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:45:03,549 - auth - DEBUG - ==================================================
2025-05-30 14:45:03,550 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:45:03,550 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:45:03,551 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'
2025-05-30 14:45:03,552 - auth - DEBUG - received_hash: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,553 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,553 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:45:03,554 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,555 - auth - DEBUG - Calculated hash: c6c8cd05da96447ad82b24c26a27b78b236b87a64b6bbe77be3fd956fbc50315
2025-05-30 14:45:03,556 - auth - DEBUG - Hash verification result: False
2025-05-30 14:45:03,556 - auth - DEBUG - ==================================================

2025-05-30 14:45:03,557 - main - WARNING - Hash verification failed
2025-05-30 14:45:03,558 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:45:03,560 - main - INFO - 

********************************************************************************
2025-05-30 14:45:03,561 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:45:03,561 - main - INFO - ********************************************************************************
2025-05-30 14:45:03,562 - main - DEBUG - Request headers:
2025-05-30 14:45:03,563 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:45:03,563 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,564 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:45:03,565 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:45:03,565 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:45:03,565 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:45:03,566 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:45:03,566 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:45:03,568 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:45:03,569 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:45:03,570 - main - DEBUG -   priority: u=1, i
2025-05-30 14:45:03,570 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,571 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:45:03,571 - main - DEBUG -   content-type: application/json
2025-05-30 14:45:03,572 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:45:03,573 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:45:03,573 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:45:03,574 - main - DEBUG -   content-length: 4
2025-05-30 14:45:03,574 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:45:03,575 - main - DEBUG -   host: localhost:8000
2025-05-30 14:45:03,576 - main - DEBUG -   connection: close
2025-05-30 14:45:03,576 - main - DEBUG - Query parameters:
2025-05-30 14:45:03,577 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQAnEL3&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,578 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'
2025-05-30 14:45:03,579 - main - DEBUG - Parsed data parameters:
2025-05-30 14:45:03,579 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQAnEL3
2025-05-30 14:45:03,581 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:45:03,581 - main - DEBUG -   auth_date: 1748605470
2025-05-30 14:45:03,582 - main - DEBUG -   signature: M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,582 - main - DEBUG -   hash: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,584 - main - DEBUG - Extracted hash value: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,584 - main - INFO - Verifying Telegram hash...
2025-05-30 14:45:03,585 - auth - DEBUG - 
==================================================
2025-05-30 14:45:03,586 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:45:03,587 - auth - DEBUG - ==================================================
2025-05-30 14:45:03,587 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:45:03,588 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:45:03,588 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg&hash=0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef'
2025-05-30 14:45:03,589 - auth - DEBUG - received_hash: 0fe5aded28ecf83d2f03eb06bcc759f947b38c435214835ca59074b9b61ce5ef
2025-05-30 14:45:03,590 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,590 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:45:03,591 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQAnEL3&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605470&signature=M7fohAzI5uFCwf2rqg8un6jf1TMVwm9nXAKTOFwq10IyNUCXYLZeniWlnspw_tMKwYuVQN_S3smc-HGdbismAg
2025-05-30 14:45:03,591 - auth - DEBUG - Calculated hash: c6c8cd05da96447ad82b24c26a27b78b236b87a64b6bbe77be3fd956fbc50315
2025-05-30 14:45:03,592 - auth - DEBUG - Hash verification result: False
2025-05-30 14:45:03,592 - auth - DEBUG - ==================================================

2025-05-30 14:45:03,593 - main - WARNING - Hash verification failed
2025-05-30 14:45:03,594 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:45:03,595 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:45:03,596 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:45:03,597 - main - INFO - [4acca6a9-157f-4c08-8c9c-24f69c1b0817] Response status: 401 - Completed in 0.0772s
2025-05-30 14:45:03,598 - main - INFO - [52a0367f-9247-461a-9b9b-7f55a4da6444] Response status: 401 - Completed in 0.0747s
2025-05-30 14:45:09,295 - main - INFO - [dd3b9858-1e90-4201-b4bd-917b015aadad] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:45:09,296 - main - INFO - [dd3b9858-1e90-4201-b4bd-917b015aadad] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:45:09,297 - main - INFO - [dd3b9858-1e90-4201-b4bd-917b015aadad] Response status: 307 - Completed in 0.0005s
2025-05-30 14:45:09,530 - main - INFO - [25c41d8e-a9b8-4b61-8459-bb3354a0d969] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:45:09,531 - main - INFO - [25c41d8e-a9b8-4b61-8459-bb3354a0d969] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:45:09,533 - main - INFO - [25c41d8e-a9b8-4b61-8459-bb3354a0d969] Response status: 307 - Completed in 0.0005s
2025-05-30 14:47:01,832 - main - INFO - ================================================================================
2025-05-30 14:47:01,832 - main - INFO - Starting Time Banking API
2025-05-30 14:47:01,832 - main - INFO - ================================================================================
2025-05-30 14:47:01,832 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:48:04,135 - main - INFO - [af219356-a0f8-46a1-bd1f-35545f7a3d06] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:48:04,136 - main - INFO - [af219356-a0f8-46a1-bd1f-35545f7a3d06] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSb1246&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'}
2025-05-30 14:48:04,137 - main - INFO - [af219356-a0f8-46a1-bd1f-35545f7a3d06] Request body: null
2025-05-30 14:48:04,139 - main - INFO - [c22c90ca-ef77-42d0-bf02-78bf952c80a8] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:48:04,140 - main - INFO - [c22c90ca-ef77-42d0-bf02-78bf952c80a8] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSb1246&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'}
2025-05-30 14:48:04,141 - main - INFO - [c22c90ca-ef77-42d0-bf02-78bf952c80a8] Request body: null
2025-05-30 14:48:04,143 - main - INFO - 

********************************************************************************
2025-05-30 14:48:04,144 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:48:04,144 - main - INFO - ********************************************************************************
2025-05-30 14:48:04,146 - main - DEBUG - Request headers:
2025-05-30 14:48:04,146 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:48:04,147 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,147 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:48:04,148 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:48:04,149 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:48:04,150 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:48:04,150 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:48:04,151 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:48:04,151 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:48:04,152 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:48:04,152 - main - DEBUG -   priority: u=1, i
2025-05-30 14:48:04,153 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,153 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,154 - main - DEBUG -   content-type: application/json
2025-05-30 14:48:04,154 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:48:04,155 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:48:04,155 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:48:04,156 - main - DEBUG -   content-length: 4
2025-05-30 14:48:04,157 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:48:04,157 - main - DEBUG -   host: localhost:8000
2025-05-30 14:48:04,158 - main - DEBUG -   connection: close
2025-05-30 14:48:04,159 - main - DEBUG - Query parameters:
2025-05-30 14:48:04,159 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSb1246&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,160 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'
2025-05-30 14:48:04,161 - main - DEBUG - Parsed data parameters:
2025-05-30 14:48:04,162 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSb1246
2025-05-30 14:48:04,163 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:48:04,163 - main - DEBUG -   auth_date: 1748605670
2025-05-30 14:48:04,164 - main - DEBUG -   signature: FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,165 - main - DEBUG -   hash: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,166 - main - DEBUG - Extracted hash value: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,166 - main - INFO - Verifying Telegram hash...
2025-05-30 14:48:04,167 - auth - DEBUG - 
==================================================
2025-05-30 14:48:04,168 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:48:04,168 - auth - DEBUG - ==================================================
2025-05-30 14:48:04,169 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:48:04,169 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:48:04,170 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'
2025-05-30 14:48:04,171 - auth - DEBUG - received_hash: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,171 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,172 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:48:04,173 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,174 - auth - DEBUG - Calculated hash: 1ae4cec3db173d78489e03b71ce5defa2c7d5fbe52040233e7d2714a27ea7dfd
2025-05-30 14:48:04,174 - auth - DEBUG - Hash verification result: False
2025-05-30 14:48:04,175 - auth - DEBUG - ==================================================

2025-05-30 14:48:04,176 - main - WARNING - Hash verification failed
2025-05-30 14:48:04,176 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:48:04,177 - main - INFO - 

********************************************************************************
2025-05-30 14:48:04,179 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:48:04,180 - main - INFO - ********************************************************************************
2025-05-30 14:48:04,180 - main - DEBUG - Request headers:
2025-05-30 14:48:04,181 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:48:04,181 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,182 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:48:04,183 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:48:04,183 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:48:04,184 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:48:04,184 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:48:04,184 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:48:04,185 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:48:04,185 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:48:04,186 - main - DEBUG -   priority: u=1, i
2025-05-30 14:48:04,186 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,187 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:48:04,187 - main - DEBUG -   content-type: application/json
2025-05-30 14:48:04,187 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:48:04,189 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:48:04,189 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:48:04,189 - main - DEBUG -   content-length: 4
2025-05-30 14:48:04,190 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:48:04,190 - main - DEBUG -   host: localhost:8000
2025-05-30 14:48:04,191 - main - DEBUG -   connection: close
2025-05-30 14:48:04,192 - main - DEBUG - Query parameters:
2025-05-30 14:48:04,192 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSb1246&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,193 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'
2025-05-30 14:48:04,194 - main - DEBUG - Parsed data parameters:
2025-05-30 14:48:04,195 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSb1246
2025-05-30 14:48:04,196 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:48:04,196 - main - DEBUG -   auth_date: 1748605670
2025-05-30 14:48:04,197 - main - DEBUG -   signature: FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,197 - main - DEBUG -   hash: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,198 - main - DEBUG - Extracted hash value: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,199 - main - INFO - Verifying Telegram hash...
2025-05-30 14:48:04,199 - auth - DEBUG - 
==================================================
2025-05-30 14:48:04,200 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:48:04,201 - auth - DEBUG - ==================================================
2025-05-30 14:48:04,201 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:48:04,202 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:48:04,202 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ&hash=752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a'
2025-05-30 14:48:04,203 - auth - DEBUG - received_hash: 752140a57997c20a1ab93cb52e3520b869e5c552a3f26c238a39b59f0e83178a
2025-05-30 14:48:04,204 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,204 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:48:04,205 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TSb1246&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605670&signature=FDdsfQzCpBmRq6I1IoDQB405--AfuL-4c57hT6tJuIgR5fl-WxYoSsFbuuPCmrKqhSsyirGV2Rv5Yd-Bwc7GAQ
2025-05-30 14:48:04,205 - auth - DEBUG - Calculated hash: 1ae4cec3db173d78489e03b71ce5defa2c7d5fbe52040233e7d2714a27ea7dfd
2025-05-30 14:48:04,206 - auth - DEBUG - Hash verification result: False
2025-05-30 14:48:04,206 - auth - DEBUG - ==================================================

2025-05-30 14:48:04,207 - main - WARNING - Hash verification failed
2025-05-30 14:48:04,207 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:48:04,209 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:48:04,209 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:48:04,211 - main - INFO - [af219356-a0f8-46a1-bd1f-35545f7a3d06] Response status: 401 - Completed in 0.0732s
2025-05-30 14:48:04,212 - main - INFO - [c22c90ca-ef77-42d0-bf02-78bf952c80a8] Response status: 401 - Completed in 0.0712s
2025-05-30 14:48:09,809 - main - INFO - [e104bbc7-02ee-493d-bd99-7bda293ef902] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:48:09,810 - main - INFO - [e104bbc7-02ee-493d-bd99-7bda293ef902] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:48:09,811 - main - INFO - [e104bbc7-02ee-493d-bd99-7bda293ef902] Response status: 307 - Completed in 0.0005s
2025-05-30 14:50:26,612 - main - INFO - ================================================================================
2025-05-30 14:50:26,612 - main - INFO - Starting Time Banking API
2025-05-30 14:50:26,615 - main - INFO - ================================================================================
2025-05-30 14:50:26,615 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:52:01,910 - main - INFO - [f847233e-429f-4167-bb55-78c9489133ef] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:52:01,912 - main - INFO - [f847233e-429f-4167-bb55-78c9489133ef] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'}
2025-05-30 14:52:01,913 - main - INFO - [f847233e-429f-4167-bb55-78c9489133ef] Request body: null
2025-05-30 14:52:01,916 - main - INFO - [58bd5c29-12c4-49ee-a9a4-2db730c1f786] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:52:01,917 - main - INFO - [58bd5c29-12c4-49ee-a9a4-2db730c1f786] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'}
2025-05-30 14:52:01,919 - main - INFO - [58bd5c29-12c4-49ee-a9a4-2db730c1f786] Request body: null
2025-05-30 14:52:01,922 - main - INFO - 

********************************************************************************
2025-05-30 14:52:01,922 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:52:01,924 - main - INFO - ********************************************************************************
2025-05-30 14:52:01,924 - main - DEBUG - Request headers:
2025-05-30 14:52:01,925 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:52:01,925 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,926 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:52:01,926 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:52:01,927 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:52:01,928 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:52:01,928 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:52:01,929 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:52:01,930 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:52:01,930 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:52:01,931 - main - DEBUG -   priority: u=1, i
2025-05-30 14:52:01,931 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,933 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,934 - main - DEBUG -   content-type: application/json
2025-05-30 14:52:01,934 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:52:01,935 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:52:01,936 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:52:01,937 - main - DEBUG -   content-length: 4
2025-05-30 14:52:01,937 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:52:01,938 - main - DEBUG -   host: localhost:8000
2025-05-30 14:52:01,939 - main - DEBUG -   connection: close
2025-05-30 14:52:01,939 - main - DEBUG - Query parameters:
2025-05-30 14:52:01,940 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,941 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:01,942 - main - DEBUG - Parsed data parameters:
2025-05-30 14:52:01,942 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQNt4ri
2025-05-30 14:52:01,943 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:52:01,944 - main - DEBUG -   auth_date: 1748605911
2025-05-30 14:52:01,945 - main - DEBUG -   signature: NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,945 - main - DEBUG -   hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,945 - main - DEBUG - Extracted hash value: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,946 - main - INFO - Verifying Telegram hash...
2025-05-30 14:52:01,947 - auth - DEBUG - 
==================================================
2025-05-30 14:52:01,947 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:52:01,948 - auth - DEBUG - ==================================================
2025-05-30 14:52:01,948 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:52:01,949 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:52:01,949 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:01,951 - auth - DEBUG - received_hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,952 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,953 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:52:01,954 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,955 - auth - DEBUG - Calculated hash: 699bf5d63c8527a40e28c246bc6fe1f969d0bdc2fc3bd0c2d7771e3e82ed50a9
2025-05-30 14:52:01,955 - auth - DEBUG - Hash verification result: False
2025-05-30 14:52:01,956 - auth - DEBUG - ==================================================

2025-05-30 14:52:01,957 - main - WARNING - Hash verification failed
2025-05-30 14:52:01,957 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:52:01,959 - main - INFO - 

********************************************************************************
2025-05-30 14:52:01,959 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:52:01,960 - main - INFO - ********************************************************************************
2025-05-30 14:52:01,961 - main - DEBUG - Request headers:
2025-05-30 14:52:01,961 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:52:01,962 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,962 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:52:01,963 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:52:01,964 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:52:01,965 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:52:01,965 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:52:01,965 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:52:01,966 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:52:01,967 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:52:01,967 - main - DEBUG -   priority: u=1, i
2025-05-30 14:52:01,968 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,969 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:01,969 - main - DEBUG -   content-type: application/json
2025-05-30 14:52:01,970 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:52:01,971 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:52:01,971 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:52:01,972 - main - DEBUG -   content-length: 4
2025-05-30 14:52:01,972 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:52:01,974 - main - DEBUG -   host: localhost:8000
2025-05-30 14:52:01,974 - main - DEBUG -   connection: close
2025-05-30 14:52:01,975 - main - DEBUG - Query parameters:
2025-05-30 14:52:01,975 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,976 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:01,976 - main - DEBUG - Parsed data parameters:
2025-05-30 14:52:01,977 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQNt4ri
2025-05-30 14:52:01,978 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:52:01,978 - main - DEBUG -   auth_date: 1748605911
2025-05-30 14:52:01,979 - main - DEBUG -   signature: NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,979 - main - DEBUG -   hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,980 - main - DEBUG - Extracted hash value: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,981 - main - INFO - Verifying Telegram hash...
2025-05-30 14:52:01,982 - auth - DEBUG - 
==================================================
2025-05-30 14:52:01,982 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:52:01,983 - auth - DEBUG - ==================================================
2025-05-30 14:52:01,983 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:52:01,984 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:52:01,985 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:01,985 - auth - DEBUG - received_hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:01,986 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,987 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:52:01,987 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:01,988 - auth - DEBUG - Calculated hash: 699bf5d63c8527a40e28c246bc6fe1f969d0bdc2fc3bd0c2d7771e3e82ed50a9
2025-05-30 14:52:01,989 - auth - DEBUG - Hash verification result: False
2025-05-30 14:52:01,990 - auth - DEBUG - ==================================================

2025-05-30 14:52:01,990 - main - WARNING - Hash verification failed
2025-05-30 14:52:01,991 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:52:01,993 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:52:01,994 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:52:01,995 - main - INFO - [f847233e-429f-4167-bb55-78c9489133ef] Response status: 401 - Completed in 0.0813s
2025-05-30 14:52:01,996 - main - INFO - [58bd5c29-12c4-49ee-a9a4-2db730c1f786] Response status: 401 - Completed in 0.0773s
2025-05-30 14:52:10,253 - main - INFO - [aea31736-7bbb-4e9b-93cb-5d77c5842a14] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:52:10,254 - main - INFO - [aea31736-7bbb-4e9b-93cb-5d77c5842a14] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:52:10,256 - main - INFO - [aea31736-7bbb-4e9b-93cb-5d77c5842a14] Response status: 307 - Completed in 0.0000s
2025-05-30 14:52:10,462 - main - INFO - [0e2c9b95-a716-4e0e-aaec-172074f21080] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:52:10,463 - main - INFO - [0e2c9b95-a716-4e0e-aaec-172074f21080] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:52:10,464 - main - INFO - [0e2c9b95-a716-4e0e-aaec-172074f21080] Response status: 307 - Completed in 0.0005s
2025-05-30 14:52:14,941 - main - INFO - [093ebc87-0b58-4eff-8658-abb04d331422] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:52:14,942 - main - INFO - [093ebc87-0b58-4eff-8658-abb04d331422] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'}
2025-05-30 14:52:14,942 - main - INFO - [093ebc87-0b58-4eff-8658-abb04d331422] Request body: null
2025-05-30 14:52:14,944 - main - INFO - [522ba588-3b65-43c5-9b29-3c0b1d560bd1] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:52:14,946 - main - INFO - [522ba588-3b65-43c5-9b29-3c0b1d560bd1] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'}
2025-05-30 14:52:14,946 - main - INFO - [522ba588-3b65-43c5-9b29-3c0b1d560bd1] Request body: null
2025-05-30 14:52:14,949 - main - INFO - 

********************************************************************************
2025-05-30 14:52:14,949 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:52:14,950 - main - INFO - ********************************************************************************
2025-05-30 14:52:14,951 - main - DEBUG - Request headers:
2025-05-30 14:52:14,952 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:52:14,952 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,953 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:52:14,954 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:52:14,954 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:52:14,955 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:52:14,955 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:52:14,956 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:52:14,957 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:52:14,957 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:52:14,958 - main - DEBUG -   priority: u=1, i
2025-05-30 14:52:14,958 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,959 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,960 - main - DEBUG -   content-type: application/json
2025-05-30 14:52:14,960 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:52:14,961 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:52:14,961 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:52:14,963 - main - DEBUG -   content-length: 4
2025-05-30 14:52:14,964 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:52:14,965 - main - DEBUG -   host: localhost:8000
2025-05-30 14:52:14,965 - main - DEBUG -   connection: close
2025-05-30 14:52:14,966 - main - DEBUG - Query parameters:
2025-05-30 14:52:14,966 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:14,967 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:14,968 - main - DEBUG - Parsed data parameters:
2025-05-30 14:52:14,969 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQNt4ri
2025-05-30 14:52:14,970 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:52:14,970 - main - DEBUG -   auth_date: 1748605911
2025-05-30 14:52:14,971 - main - DEBUG -   signature: NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:14,971 - main - DEBUG -   hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:14,973 - main - DEBUG - Extracted hash value: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:14,973 - main - INFO - Verifying Telegram hash...
2025-05-30 14:52:14,974 - auth - DEBUG - 
==================================================
2025-05-30 14:52:14,975 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:52:14,975 - auth - DEBUG - ==================================================
2025-05-30 14:52:14,976 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:52:14,977 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:52:14,978 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:14,978 - auth - DEBUG - received_hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:14,979 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:14,980 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:52:14,981 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:14,981 - auth - DEBUG - Calculated hash: 699bf5d63c8527a40e28c246bc6fe1f969d0bdc2fc3bd0c2d7771e3e82ed50a9
2025-05-30 14:52:14,982 - auth - DEBUG - Hash verification result: False
2025-05-30 14:52:14,983 - auth - DEBUG - ==================================================

2025-05-30 14:52:14,984 - main - WARNING - Hash verification failed
2025-05-30 14:52:14,986 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:52:14,987 - main - INFO - 

********************************************************************************
2025-05-30 14:52:14,988 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:52:14,989 - main - INFO - ********************************************************************************
2025-05-30 14:52:14,990 - main - DEBUG - Request headers:
2025-05-30 14:52:14,991 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:52:14,991 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,992 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:52:14,992 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:52:14,993 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:52:14,994 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:52:14,995 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:52:14,996 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:52:14,996 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:52:14,997 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:52:14,997 - main - DEBUG -   priority: u=1, i
2025-05-30 14:52:14,998 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,999 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:52:14,999 - main - DEBUG -   content-type: application/json
2025-05-30 14:52:15,000 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:52:15,001 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:52:15,002 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:52:15,002 - main - DEBUG -   content-length: 4
2025-05-30 14:52:15,003 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:52:15,004 - main - DEBUG -   host: localhost:8000
2025-05-30 14:52:15,005 - main - DEBUG -   connection: close
2025-05-30 14:52:15,005 - main - DEBUG - Query parameters:
2025-05-30 14:52:15,006 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TQNt4ri&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:15,007 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:15,008 - main - DEBUG - Parsed data parameters:
2025-05-30 14:52:15,008 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TQNt4ri
2025-05-30 14:52:15,009 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:52:15,010 - main - DEBUG -   auth_date: 1748605911
2025-05-30 14:52:15,010 - main - DEBUG -   signature: NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:15,011 - main - DEBUG -   hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:15,012 - main - DEBUG - Extracted hash value: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:15,012 - main - INFO - Verifying Telegram hash...
2025-05-30 14:52:15,013 - auth - DEBUG - 
==================================================
2025-05-30 14:52:15,013 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:52:15,014 - auth - DEBUG - ==================================================
2025-05-30 14:52:15,015 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:52:15,015 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:52:15,016 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ&hash=d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f'
2025-05-30 14:52:15,017 - auth - DEBUG - received_hash: d7a863a61936f4ecee242c2c559bdf2070d5feff6851a640dd16945e14fd294f
2025-05-30 14:52:15,018 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:15,018 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:52:15,019 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TQNt4ri&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748605911&signature=NqmKOKhDTNrqVciK8qw889ZmnVcnq4K_s6whfi_yawZ601WBxBYup_gAPbizEo7gv2ZMjqn1M6dERVQ7kqcGAQ
2025-05-30 14:52:15,020 - auth - DEBUG - Calculated hash: 699bf5d63c8527a40e28c246bc6fe1f969d0bdc2fc3bd0c2d7771e3e82ed50a9
2025-05-30 14:52:15,021 - auth - DEBUG - Hash verification result: False
2025-05-30 14:52:15,022 - auth - DEBUG - ==================================================

2025-05-30 14:52:15,023 - main - WARNING - Hash verification failed
2025-05-30 14:52:15,024 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:52:15,025 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:52:15,026 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:52:15,027 - main - INFO - [093ebc87-0b58-4eff-8658-abb04d331422] Response status: 401 - Completed in 0.0834s
2025-05-30 14:52:15,029 - main - INFO - [522ba588-3b65-43c5-9b29-3c0b1d560bd1] Response status: 401 - Completed in 0.0824s
2025-05-30 14:52:20,454 - main - INFO - [11bc9ae4-e0df-4330-8f60-aa74008be5a0] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:52:20,455 - main - INFO - [11bc9ae4-e0df-4330-8f60-aa74008be5a0] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:52:20,456 - main - INFO - [11bc9ae4-e0df-4330-8f60-aa74008be5a0] Response status: 307 - Completed in 0.0006s
2025-05-30 14:52:20,678 - main - INFO - [42eb6e84-357c-4ec4-8098-02cc0306762c] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:52:20,679 - main - INFO - [42eb6e84-357c-4ec4-8098-02cc0306762c] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:52:20,681 - main - INFO - [42eb6e84-357c-4ec4-8098-02cc0306762c] Response status: 307 - Completed in 0.0011s
2025-05-30 14:54:53,851 - main - INFO - ================================================================================
2025-05-30 14:54:53,852 - main - INFO - Starting Time Banking API
2025-05-30 14:54:53,852 - main - INFO - ================================================================================
2025-05-30 14:54:53,853 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 14:55:44,973 - main - INFO - [4c5da705-097c-478d-accf-e16c314fad24] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:55:44,975 - main - INFO - [4c5da705-097c-478d-accf-e16c314fad24] Request body: ------WebKitFormBoundaryQJDPBmZsYR4nPJhV
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
------WebKitFormBoundaryQJDPBmZsYR4nPJhV--

2025-05-30 14:55:44,979 - main - INFO - [2ae1c7f0-a7f4-4339-9fa8-70993be29ce6] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:55:44,981 - main - INFO - [2ae1c7f0-a7f4-4339-9fa8-70993be29ce6] Request body: ------WebKitFormBoundaryKWnsBml5zf7bOY4I
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
------WebKitFormBoundaryKWnsBml5zf7bOY4I--

2025-05-30 14:55:44,985 - main - INFO - 

********************************************************************************
2025-05-30 14:55:44,986 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:55:44,987 - main - INFO - ********************************************************************************
2025-05-30 14:55:44,989 - main - DEBUG - Request headers:
2025-05-30 14:55:44,990 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:55:44,991 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:44,992 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:55:44,993 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:55:44,994 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:55:44,995 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:55:44,996 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:55:44,998 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:55:44,999 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:55:44,999 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:55:45,000 - main - DEBUG -   priority: u=1, i
2025-05-30 14:55:45,001 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,003 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,004 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundaryQJDPBmZsYR4nPJhV
2025-05-30 14:55:45,005 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:55:45,007 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:55:45,008 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:55:45,009 - main - DEBUG -   content-length: 686
2025-05-30 14:55:45,009 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:55:45,010 - main - DEBUG -   host: localhost:8000
2025-05-30 14:55:45,011 - main - DEBUG -   connection: close
2025-05-30 14:55:45,012 - main - DEBUG - Query parameters:
2025-05-30 14:55:45,013 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 14:55:45,014 - main - ERROR - No init_data parameter provided in request
2025-05-30 14:55:45,016 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:55:45,017 - main - INFO - 

********************************************************************************
2025-05-30 14:55:45,018 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:55:45,020 - main - INFO - ********************************************************************************
2025-05-30 14:55:45,021 - main - DEBUG - Request headers:
2025-05-30 14:55:45,022 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:55:45,023 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,024 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:55:45,025 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:55:45,026 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:55:45,027 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:55:45,028 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:55:45,029 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:55:45,030 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:55:45,031 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:55:45,032 - main - DEBUG -   priority: u=1, i
2025-05-30 14:55:45,033 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,034 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,035 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundaryKWnsBml5zf7bOY4I
2025-05-30 14:55:45,037 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:55:45,038 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:55:45,039 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:55:45,040 - main - DEBUG -   content-length: 686
2025-05-30 14:55:45,041 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:55:45,042 - main - DEBUG -   host: localhost:8000
2025-05-30 14:55:45,043 - main - DEBUG -   connection: close
2025-05-30 14:55:45,044 - main - DEBUG - Query parameters:
2025-05-30 14:55:45,045 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 14:55:45,046 - main - ERROR - No init_data parameter provided in request
2025-05-30 14:55:45,047 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:55:45,049 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 14:55:45,051 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 14:55:45,053 - main - INFO - [4c5da705-097c-478d-accf-e16c314fad24] Response status: 400 - Completed in 0.0757s
2025-05-30 14:55:45,054 - main - INFO - [2ae1c7f0-a7f4-4339-9fa8-70993be29ce6] Response status: 400 - Completed in 0.0722s
2025-05-30 14:55:45,285 - main - INFO - [2f680b9e-2ce3-47db-beea-c4d6b79b42c6] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:55:45,287 - main - INFO - [2f680b9e-2ce3-47db-beea-c4d6b79b42c6] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'}
2025-05-30 14:55:45,288 - main - INFO - [f2f12ece-74af-4eb6-954d-bdbcb777ec0d] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 14:55:45,289 - main - INFO - [f2f12ece-74af-4eb6-954d-bdbcb777ec0d] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'}
2025-05-30 14:55:45,291 - main - INFO - 

********************************************************************************
2025-05-30 14:55:45,292 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:55:45,293 - main - INFO - ********************************************************************************
2025-05-30 14:55:45,294 - main - DEBUG - Request headers:
2025-05-30 14:55:45,295 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:55:45,295 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,296 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:55:45,297 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:55:45,298 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:55:45,299 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:55:45,299 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:55:45,300 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:55:45,301 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:55:45,302 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:55:45,302 - main - DEBUG -   priority: u=1, i
2025-05-30 14:55:45,303 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,304 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,305 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:55:45,305 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:55:45,306 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:55:45,306 - main - DEBUG -   content-length: 0
2025-05-30 14:55:45,307 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:55:45,308 - main - DEBUG -   host: localhost:8000
2025-05-30 14:55:45,309 - main - DEBUG -   connection: close
2025-05-30 14:55:45,310 - main - DEBUG - Query parameters:
2025-05-30 14:55:45,310 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,311 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'
2025-05-30 14:55:45,312 - main - DEBUG - Parsed data parameters:
2025-05-30 14:55:45,313 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TTLNlJ_
2025-05-30 14:55:45,313 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:55:45,314 - main - DEBUG -   auth_date: 1748606136
2025-05-30 14:55:45,314 - main - DEBUG -   signature: oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,315 - main - DEBUG -   hash: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,316 - main - DEBUG - Extracted hash value: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,317 - main - INFO - Verifying Telegram hash...
2025-05-30 14:55:45,318 - auth - DEBUG - 
==================================================
2025-05-30 14:55:45,319 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:55:45,319 - auth - DEBUG - ==================================================
2025-05-30 14:55:45,320 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:55:45,320 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:55:45,322 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'
2025-05-30 14:55:45,323 - auth - DEBUG - received_hash: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,324 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,325 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:55:45,325 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,326 - auth - DEBUG - Calculated hash: cb23fc4ef3ebab39aeafa1eae119c80a9abba4cbed9f454b729b72e5f1104ec2
2025-05-30 14:55:45,327 - auth - DEBUG - Hash verification result: False
2025-05-30 14:55:45,328 - auth - DEBUG - ==================================================

2025-05-30 14:55:45,329 - main - WARNING - Hash verification failed
2025-05-30 14:55:45,329 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:55:45,330 - main - INFO - 

********************************************************************************
2025-05-30 14:55:45,331 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 14:55:45,332 - main - INFO - ********************************************************************************
2025-05-30 14:55:45,333 - main - DEBUG - Request headers:
2025-05-30 14:55:45,334 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 14:55:45,334 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,335 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 14:55:45,336 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 14:55:45,337 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 14:55:45,338 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 14:55:45,339 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 14:55:45,339 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 14:55:45,340 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 14:55:45,340 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 14:55:45,341 - main - DEBUG -   priority: u=1, i
2025-05-30 14:55:45,342 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,342 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 14:55:45,343 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 14:55:45,344 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 14:55:45,344 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 14:55:45,345 - main - DEBUG -   content-length: 0
2025-05-30 14:55:45,346 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 14:55:45,347 - main - DEBUG -   host: localhost:8000
2025-05-30 14:55:45,347 - main - DEBUG -   connection: close
2025-05-30 14:55:45,348 - main - DEBUG - Query parameters:
2025-05-30 14:55:45,349 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TTLNlJ_&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,349 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'
2025-05-30 14:55:45,351 - main - DEBUG - Parsed data parameters:
2025-05-30 14:55:45,352 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TTLNlJ_
2025-05-30 14:55:45,352 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 14:55:45,353 - main - DEBUG -   auth_date: 1748606136
2025-05-30 14:55:45,353 - main - DEBUG -   signature: oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,354 - main - DEBUG -   hash: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,354 - main - DEBUG - Extracted hash value: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,356 - main - INFO - Verifying Telegram hash...
2025-05-30 14:55:45,357 - auth - DEBUG - 
==================================================
2025-05-30 14:55:45,357 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 14:55:45,358 - auth - DEBUG - ==================================================
2025-05-30 14:55:45,359 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 14:55:45,359 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 14:55:45,360 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA&hash=0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf'
2025-05-30 14:55:45,361 - auth - DEBUG - received_hash: 0e9edf9074354fd75d0739c566da9f46298294d9d98414f3f02cae226b6316bf
2025-05-30 14:55:45,362 - auth - DEBUG - Data without hash: query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,363 - auth - DEBUG - Secret key created (first 5 bytes): b'7\x9a\xa6{\x19'
2025-05-30 14:55:45,364 - auth - DEBUG - Data check string: query_id=AAFreO00AAAAAGt47TTLNlJ_&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606136&signature=oNBDKZzSekRlcYjp2SAivGvRHDu-pSSrtbupUsV9s7Lb9J4q3or5CbDn3WnjIsqAD3C8iEWhDptiaVgGfx2YDA
2025-05-30 14:55:45,364 - auth - DEBUG - Calculated hash: cb23fc4ef3ebab39aeafa1eae119c80a9abba4cbed9f454b729b72e5f1104ec2
2025-05-30 14:55:45,365 - auth - DEBUG - Hash verification result: False
2025-05-30 14:55:45,366 - auth - DEBUG - ==================================================

2025-05-30 14:55:45,366 - main - WARNING - Hash verification failed
2025-05-30 14:55:45,367 - main - ERROR - Authentication failed with HTTPException
2025-05-30 14:55:45,369 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:55:45,369 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 14:55:45,371 - main - INFO - [2f680b9e-2ce3-47db-beea-c4d6b79b42c6] Response status: 401 - Completed in 0.0833s
2025-05-30 14:55:45,372 - main - INFO - [f2f12ece-74af-4eb6-954d-bdbcb777ec0d] Response status: 401 - Completed in 0.0818s
2025-05-30 14:56:21,456 - main - INFO - [e7dcf22a-844f-4a94-ac50-0dfc7d1a28e8] Request from 77.91.101.132:0 - GET /listings
2025-05-30 14:56:21,457 - main - INFO - [e7dcf22a-844f-4a94-ac50-0dfc7d1a28e8] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 14:56:21,459 - main - INFO - [e7dcf22a-844f-4a94-ac50-0dfc7d1a28e8] Response status: 307 - Completed in 0.0011s
2025-05-30 14:59:54,273 - main - INFO - ================================================================================
2025-05-30 14:59:54,274 - main - INFO - Starting Time Banking API
2025-05-30 14:59:54,274 - main - INFO - ================================================================================
2025-05-30 14:59:54,275 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 15:00:00,353 - main - INFO - [26568488-d25d-4ea4-8a69-bd290e7aeaac] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:00:00,355 - main - INFO - [26568488-d25d-4ea4-8a69-bd290e7aeaac] Request body: ------WebKitFormBoundaryEF0EtjvLBRjA7vPW
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
------WebKitFormBoundaryEF0EtjvLBRjA7vPW--

2025-05-30 15:00:00,356 - main - INFO - [ed0240cd-3320-4fcf-b638-e4626f80c4a2] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:00:00,357 - main - INFO - [ed0240cd-3320-4fcf-b638-e4626f80c4a2] Request body: ------WebKitFormBoundaryeX3ZnHcFoVJ87qnz
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
------WebKitFormBoundaryeX3ZnHcFoVJ87qnz--

2025-05-30 15:00:00,359 - main - INFO - 

********************************************************************************
2025-05-30 15:00:00,360 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:00:00,361 - main - INFO - ********************************************************************************
2025-05-30 15:00:00,361 - main - DEBUG - Request headers:
2025-05-30 15:00:00,362 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:00:00,363 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,363 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:00:00,364 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:00:00,365 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:00:00,365 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:00:00,365 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:00:00,365 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:00:00,367 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:00:00,367 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:00:00,368 - main - DEBUG -   priority: u=1, i
2025-05-30 15:00:00,369 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,370 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,371 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundaryEF0EtjvLBRjA7vPW
2025-05-30 15:00:00,371 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:00:00,372 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:00:00,373 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:00:00,374 - main - DEBUG -   content-length: 686
2025-05-30 15:00:00,374 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:00:00,375 - main - DEBUG -   host: localhost:8000
2025-05-30 15:00:00,376 - main - DEBUG -   connection: close
2025-05-30 15:00:00,377 - main - DEBUG - Query parameters:
2025-05-30 15:00:00,377 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 15:00:00,378 - main - ERROR - No init_data parameter provided in request
2025-05-30 15:00:00,379 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:00:00,380 - main - INFO - 

********************************************************************************
2025-05-30 15:00:00,381 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:00:00,382 - main - INFO - ********************************************************************************
2025-05-30 15:00:00,383 - main - DEBUG - Request headers:
2025-05-30 15:00:00,383 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:00:00,384 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,385 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:00:00,386 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:00:00,386 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:00:00,386 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:00:00,387 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:00:00,388 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:00:00,389 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:00:00,389 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:00:00,390 - main - DEBUG -   priority: u=1, i
2025-05-30 15:00:00,391 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,391 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,392 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundaryeX3ZnHcFoVJ87qnz
2025-05-30 15:00:00,393 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:00:00,394 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:00:00,394 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:00:00,395 - main - DEBUG -   content-length: 686
2025-05-30 15:00:00,396 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:00:00,396 - main - DEBUG -   host: localhost:8000
2025-05-30 15:00:00,397 - main - DEBUG -   connection: close
2025-05-30 15:00:00,398 - main - DEBUG - Query parameters:
2025-05-30 15:00:00,399 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 15:00:00,399 - main - ERROR - No init_data parameter provided in request
2025-05-30 15:00:00,400 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:00:00,402 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 15:00:00,404 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 15:00:00,406 - main - INFO - [26568488-d25d-4ea4-8a69-bd290e7aeaac] Response status: 400 - Completed in 0.0495s
2025-05-30 15:00:00,408 - main - INFO - [ed0240cd-3320-4fcf-b638-e4626f80c4a2] Response status: 400 - Completed in 0.0495s
2025-05-30 15:00:00,701 - main - INFO - [e2342bd3-5de2-4cf8-9f70-f501cf05d0ed] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:00:00,703 - main - INFO - [e2342bd3-5de2-4cf8-9f70-f501cf05d0ed] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'}
2025-05-30 15:00:00,704 - main - INFO - 

********************************************************************************
2025-05-30 15:00:00,705 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:00:00,706 - main - INFO - ********************************************************************************
2025-05-30 15:00:00,707 - main - DEBUG - Request headers:
2025-05-30 15:00:00,708 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:00:00,708 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,709 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:00:00,710 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:00:00,710 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:00:00,711 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:00:00,711 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:00:00,712 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:00:00,713 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:00:00,713 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:00:00,714 - main - DEBUG -   priority: u=1, i
2025-05-30 15:00:00,714 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,715 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,716 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:00:00,716 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:00:00,717 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:00:00,717 - main - DEBUG -   content-length: 0
2025-05-30 15:00:00,719 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:00:00,720 - main - DEBUG -   host: localhost:8000
2025-05-30 15:00:00,721 - main - DEBUG -   connection: close
2025-05-30 15:00:00,721 - main - DEBUG - Query parameters:
2025-05-30 15:00:00,722 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,723 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSMMiWh&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'
2025-05-30 15:00:00,723 - main - DEBUG - Parsed data parameters:
2025-05-30 15:00:00,724 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSMMiWh
2025-05-30 15:00:00,724 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:00:00,725 - main - DEBUG -   auth_date: 1748606392
2025-05-30 15:00:00,726 - main - DEBUG -   signature: OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg
2025-05-30 15:00:00,726 - main - DEBUG -   hash: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,727 - main - DEBUG - Extracted hash value: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,727 - main - INFO - Verifying Telegram hash...
2025-05-30 15:00:00,728 - auth - DEBUG - 
==================================================
2025-05-30 15:00:00,729 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 15:00:00,729 - auth - DEBUG - ==================================================
2025-05-30 15:00:00,730 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 15:00:00,730 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 15:00:00,731 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSMMiWh&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'
2025-05-30 15:00:00,732 - auth - DEBUG - received_hash: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,733 - auth - DEBUG - Data check string: auth_date=1748606392
query_id=AAFreO00AAAAAGt47TSMMiWh
signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg
user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:00:00,733 - auth - DEBUG - Secret key created (first 5 bytes): b'\xa9N \x1e\xb2'
2025-05-30 15:00:00,734 - auth - DEBUG - Calculated hash: e8cc7de5715e748a75722a192708cbd8523d014ed4d1ec9dadaba1024e321c50
2025-05-30 15:00:00,734 - auth - DEBUG - Hash verification result: False
2025-05-30 15:00:00,735 - auth - DEBUG - ==================================================

2025-05-30 15:00:00,736 - main - WARNING - Hash verification failed
2025-05-30 15:00:00,737 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:00:00,739 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 15:00:00,740 - main - INFO - [e2342bd3-5de2-4cf8-9f70-f501cf05d0ed] Response status: 401 - Completed in 0.0364s
2025-05-30 15:00:00,769 - main - INFO - [dd57bf49-22a8-4389-8c48-2d7d2583c307] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:00:00,771 - main - INFO - [dd57bf49-22a8-4389-8c48-2d7d2583c307] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'}
2025-05-30 15:00:00,774 - main - INFO - 

********************************************************************************
2025-05-30 15:00:00,774 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:00:00,775 - main - INFO - ********************************************************************************
2025-05-30 15:00:00,776 - main - DEBUG - Request headers:
2025-05-30 15:00:00,777 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:00:00,777 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,778 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:00:00,778 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:00:00,779 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:00:00,779 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:00:00,780 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:00:00,781 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:00:00,782 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:00:00,782 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:00:00,783 - main - DEBUG -   priority: u=1, i
2025-05-30 15:00:00,784 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,784 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:00:00,785 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:00:00,786 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:00:00,786 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:00:00,787 - main - DEBUG -   content-length: 0
2025-05-30 15:00:00,787 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:00:00,788 - main - DEBUG -   host: localhost:8000
2025-05-30 15:00:00,789 - main - DEBUG -   connection: close
2025-05-30 15:00:00,789 - main - DEBUG - Query parameters:
2025-05-30 15:00:00,790 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSMMiWh&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,791 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSMMiWh&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'
2025-05-30 15:00:00,792 - main - DEBUG - Parsed data parameters:
2025-05-30 15:00:00,793 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSMMiWh
2025-05-30 15:00:00,793 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:00:00,794 - main - DEBUG -   auth_date: 1748606392
2025-05-30 15:00:00,795 - main - DEBUG -   signature: OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg
2025-05-30 15:00:00,796 - main - DEBUG -   hash: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,796 - main - DEBUG - Extracted hash value: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,797 - main - INFO - Verifying Telegram hash...
2025-05-30 15:00:00,799 - auth - DEBUG - 
==================================================
2025-05-30 15:00:00,799 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 15:00:00,799 - auth - DEBUG - ==================================================
2025-05-30 15:00:00,800 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 15:00:00,801 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 15:00:00,802 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSMMiWh&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606392&signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg&hash=ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4'
2025-05-30 15:00:00,803 - auth - DEBUG - received_hash: ea4bd4c4bb6747e73537ad5f28b68e8c4a57f7bdde2e33e9629a9265b442d3e4
2025-05-30 15:00:00,804 - auth - DEBUG - Data check string: auth_date=1748606392
query_id=AAFreO00AAAAAGt47TSMMiWh
signature=OqbVCR7Rq5lGm-Ngi3GVbpxNTrUPkWwBk5igEAgGQVs4yohzU8uHQehd_mh2cyv5pav0twovCzcZHvLL0NqZDg
user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:00:00,804 - auth - DEBUG - Secret key created (first 5 bytes): b'\xa9N \x1e\xb2'
2025-05-30 15:00:00,805 - auth - DEBUG - Calculated hash: e8cc7de5715e748a75722a192708cbd8523d014ed4d1ec9dadaba1024e321c50
2025-05-30 15:00:00,806 - auth - DEBUG - Hash verification result: False
2025-05-30 15:00:00,807 - auth - DEBUG - ==================================================

2025-05-30 15:00:00,808 - main - WARNING - Hash verification failed
2025-05-30 15:00:00,810 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:00:00,811 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 15:00:00,812 - main - INFO - [dd57bf49-22a8-4389-8c48-2d7d2583c307] Response status: 401 - Completed in 0.0396s
2025-05-30 15:00:04,828 - main - INFO - [fc9e5701-0a77-4b58-b310-290b4db19492] Request from 77.91.101.132:0 - GET /listings
2025-05-30 15:00:04,829 - main - INFO - [fc9e5701-0a77-4b58-b310-290b4db19492] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 15:00:04,831 - main - INFO - [fc9e5701-0a77-4b58-b310-290b4db19492] Response status: 307 - Completed in 0.0005s
2025-05-30 15:00:05,108 - main - INFO - [353268b6-a42a-40f0-b52c-e0f44b36bb3f] Request from 77.91.101.132:0 - GET /listings
2025-05-30 15:00:05,109 - main - INFO - [353268b6-a42a-40f0-b52c-e0f44b36bb3f] Query params: {'skip': '0', 'limit': '5'}
2025-05-30 15:00:05,111 - main - INFO - [353268b6-a42a-40f0-b52c-e0f44b36bb3f] Response status: 307 - Completed in 0.0000s
2025-05-30 15:01:01,300 - main - INFO - ================================================================================
2025-05-30 15:01:01,300 - main - INFO - Starting Time Banking API
2025-05-30 15:01:01,300 - main - INFO - ================================================================================
2025-05-30 15:01:01,303 - main - INFO - Bot token: 80221..._4-bU (length: 46)
2025-05-30 15:01:08,772 - main - INFO - [13b4c8d7-8968-4bed-ae10-02c9ab4cd135] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:01:08,774 - main - INFO - [13b4c8d7-8968-4bed-ae10-02c9ab4cd135] Request body: ------WebKitFormBoundary9HXkL5NwG2oRozkb
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
------WebKitFormBoundary9HXkL5NwG2oRozkb--

2025-05-30 15:01:08,776 - main - INFO - [80b9603b-6c51-4428-afb0-f523e96feaae] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:01:08,776 - main - INFO - [80b9603b-6c51-4428-afb0-f523e96feaae] Request body: ------WebKitFormBoundaryV5Q8PPAnBGUmV6YB
Content-Disposition: form-data; name="init_data"

query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
------WebKitFormBoundaryV5Q8PPAnBGUmV6YB--

2025-05-30 15:01:08,778 - main - INFO - 

********************************************************************************
2025-05-30 15:01:08,778 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:01:08,778 - main - INFO - ********************************************************************************
2025-05-30 15:01:08,778 - main - DEBUG - Request headers:
2025-05-30 15:01:08,778 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:01:08,782 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,783 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:01:08,783 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:01:08,783 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:01:08,783 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:01:08,783 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:01:08,783 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:01:08,786 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:01:08,787 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:01:08,787 - main - DEBUG -   priority: u=1, i
2025-05-30 15:01:08,787 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,787 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,787 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundary9HXkL5NwG2oRozkb
2025-05-30 15:01:08,787 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:01:08,790 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:01:08,790 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:01:08,790 - main - DEBUG -   content-length: 686
2025-05-30 15:01:08,790 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:01:08,790 - main - DEBUG -   host: localhost:8000
2025-05-30 15:01:08,790 - main - DEBUG -   connection: close
2025-05-30 15:01:08,790 - main - DEBUG - Query parameters:
2025-05-30 15:01:08,790 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 15:01:08,790 - main - ERROR - No init_data parameter provided in request
2025-05-30 15:01:08,796 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:01:08,796 - main - INFO - 

********************************************************************************
2025-05-30 15:01:08,797 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:01:08,797 - main - INFO - ********************************************************************************
2025-05-30 15:01:08,798 - main - DEBUG - Request headers:
2025-05-30 15:01:08,798 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:01:08,798 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,800 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:01:08,800 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:01:08,800 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:01:08,800 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:01:08,800 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:01:08,800 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:01:08,800 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:01:08,804 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:01:08,804 - main - DEBUG -   priority: u=1, i
2025-05-30 15:01:08,805 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,806 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:08,807 - main - DEBUG -   content-type: multipart/form-data; boundary=----WebKitFormBoundaryV5Q8PPAnBGUmV6YB
2025-05-30 15:01:08,807 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:01:08,807 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:01:08,807 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:01:08,807 - main - DEBUG -   content-length: 686
2025-05-30 15:01:08,809 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:01:08,810 - main - DEBUG -   host: localhost:8000
2025-05-30 15:01:08,810 - main - DEBUG -   connection: close
2025-05-30 15:01:08,811 - main - DEBUG - Query parameters:
2025-05-30 15:01:08,811 - main - DEBUG - Raw init_data (repr): ''
2025-05-30 15:01:08,811 - main - ERROR - No init_data parameter provided in request
2025-05-30 15:01:08,811 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:01:08,813 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 15:01:08,815 - main - ERROR - HTTP exception: 400 - Missing init_data parameter
2025-05-30 15:01:08,817 - main - INFO - [13b4c8d7-8968-4bed-ae10-02c9ab4cd135] Response status: 400 - Completed in 0.0407s
2025-05-30 15:01:08,818 - main - INFO - [80b9603b-6c51-4428-afb0-f523e96feaae] Response status: 400 - Completed in 0.0414s
2025-05-30 15:01:09,122 - main - INFO - [5870ce04-148c-4df7-9e33-f186b2ab733b] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:01:09,123 - main - INFO - [5870ce04-148c-4df7-9e33-f186b2ab733b] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'}
2025-05-30 15:01:09,125 - main - INFO - [037c324c-dedb-44ec-b50d-de6967d785f2] Request from 77.91.101.132:0 - POST /auth/telegram
2025-05-30 15:01:09,125 - main - INFO - [037c324c-dedb-44ec-b50d-de6967d785f2] Query params: {'init_data': 'query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'}
2025-05-30 15:01:09,127 - main - INFO - 

********************************************************************************
2025-05-30 15:01:09,128 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:01:09,128 - main - INFO - ********************************************************************************
2025-05-30 15:01:09,128 - main - DEBUG - Request headers:
2025-05-30 15:01:09,131 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:01:09,131 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,131 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:01:09,132 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:01:09,132 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:01:09,132 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:01:09,132 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:01:09,132 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:01:09,135 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:01:09,136 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:01:09,137 - main - DEBUG -   priority: u=1, i
2025-05-30 15:01:09,138 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,138 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,138 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:01:09,139 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:01:09,139 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:01:09,139 - main - DEBUG -   content-length: 0
2025-05-30 15:01:09,139 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:01:09,139 - main - DEBUG -   host: localhost:8000
2025-05-30 15:01:09,139 - main - DEBUG -   connection: close
2025-05-30 15:01:09,143 - main - DEBUG - Query parameters:
2025-05-30 15:01:09,143 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,143 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSxQD0R&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'
2025-05-30 15:01:09,146 - main - DEBUG - Parsed data parameters:
2025-05-30 15:01:09,146 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSxQD0R
2025-05-30 15:01:09,147 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:01:09,148 - main - DEBUG -   auth_date: 1748606464
2025-05-30 15:01:09,148 - main - DEBUG -   signature: dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw
2025-05-30 15:01:09,149 - main - DEBUG -   hash: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,150 - main - DEBUG - Extracted hash value: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,150 - main - INFO - Verifying Telegram hash...
2025-05-30 15:01:09,151 - auth - DEBUG - 
==================================================
2025-05-30 15:01:09,152 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 15:01:09,152 - auth - DEBUG - ==================================================
2025-05-30 15:01:09,152 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 15:01:09,152 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 15:01:09,155 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSxQD0R&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'
2025-05-30 15:01:09,155 - auth - DEBUG - received_hash: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,156 - auth - DEBUG - Data check string: auth_date=1748606464
query_id=AAFreO00AAAAAGt47TSxQD0R
signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw
user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:01:09,157 - auth - DEBUG - Secret key created (first 5 bytes): b'\xa9N \x1e\xb2'
2025-05-30 15:01:09,158 - auth - DEBUG - Calculated hash: 76cc0eebdaeb1c0371e52ffb698b34980a0e13b1bb72d35d6d434b0836dc232e
2025-05-30 15:01:09,159 - auth - DEBUG - Hash verification result: False
2025-05-30 15:01:09,160 - auth - DEBUG - ==================================================

2025-05-30 15:01:09,160 - main - WARNING - Hash verification failed
2025-05-30 15:01:09,161 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:01:09,162 - main - INFO - 

********************************************************************************
2025-05-30 15:01:09,163 - main - INFO - === Starting Telegram Authentication ===
2025-05-30 15:01:09,164 - main - INFO - ********************************************************************************
2025-05-30 15:01:09,165 - main - DEBUG - Request headers:
2025-05-30 15:01:09,165 - main - DEBUG -   x-forwarded-proto: https
2025-05-30 15:01:09,166 - main - DEBUG -   x-forwarded-host: 66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,166 - main - DEBUG -   x-forwarded-for: 77.91.101.132
2025-05-30 15:01:09,167 - main - DEBUG -   sec-fetch-site: same-origin
2025-05-30 15:01:09,167 - main - DEBUG -   sec-fetch-mode: cors
2025-05-30 15:01:09,168 - main - DEBUG -   sec-fetch-dest: empty
2025-05-30 15:01:09,168 - main - DEBUG -   sec-ch-ua-platform: "Windows"
2025-05-30 15:01:09,169 - main - DEBUG -   sec-ch-ua-mobile: ?0
2025-05-30 15:01:09,170 - main - DEBUG -   sec-ch-ua: "Microsoft Edge";v="136", "Microsoft Edge WebView2";v="136", "Not.A/Brand";v="99", "Chromium";v="136"
2025-05-30 15:01:09,170 - main - DEBUG -   referer: https://66fb-77-91-101-132.ngrok-free.app/
2025-05-30 15:01:09,171 - main - DEBUG -   priority: u=1, i
2025-05-30 15:01:09,172 - main - DEBUG -   origin: https://66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,173 - main - DEBUG -   cookie: abuse_interstitial=66fb-77-91-101-132.ngrok-free.app
2025-05-30 15:01:09,173 - main - DEBUG -   accept-language: ru,en;q=0.9,en-GB;q=0.8,en-US;q=0.7
2025-05-30 15:01:09,174 - main - DEBUG -   accept-encoding: gzip, deflate, br, zstd
2025-05-30 15:01:09,175 - main - DEBUG -   accept: application/json, text/plain, */*
2025-05-30 15:01:09,175 - main - DEBUG -   content-length: 0
2025-05-30 15:01:09,176 - main - DEBUG -   user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0
2025-05-30 15:01:09,176 - main - DEBUG -   host: localhost:8000
2025-05-30 15:01:09,177 - main - DEBUG -   connection: close
2025-05-30 15:01:09,178 - main - DEBUG - Query parameters:
2025-05-30 15:01:09,179 - main - DEBUG -   init_data: query_id=AAFreO00AAAAAGt47TSxQD0R&user=%7B%22id%22%3A887978091%2C%22first_name%22%3A%22.%22%2C%22last_name%22%3A%22.%22%2C%22username%22%3A%22sar_a_to_v%22%2C%22language_code%22%3A%22ru%22%2C%22allows_write_to_pm%22%3Atrue%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Ft.me%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2F1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg%22%7D&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,179 - main - DEBUG - Raw init_data (repr): 'query_id=AAFreO00AAAAAGt47TSxQD0R&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'
2025-05-30 15:01:09,179 - main - DEBUG - Parsed data parameters:
2025-05-30 15:01:09,179 - main - DEBUG -   query_id: AAFreO00AAAAAGt47TSxQD0R
2025-05-30 15:01:09,179 - main - DEBUG -   user: {"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:01:09,179 - main - DEBUG -   auth_date: 1748606464
2025-05-30 15:01:09,182 - main - DEBUG -   signature: dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw
2025-05-30 15:01:09,183 - main - DEBUG -   hash: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,183 - main - DEBUG - Extracted hash value: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,183 - main - INFO - Verifying Telegram hash...
2025-05-30 15:01:09,185 - auth - DEBUG - 
==================================================
2025-05-30 15:01:09,186 - auth - DEBUG - Starting Telegram WebApp hash verification
2025-05-30 15:01:09,186 - auth - DEBUG - ==================================================
2025-05-30 15:01:09,187 - auth - DEBUG - BOT_TOKEN (repr): '8022193791:AAEAt9a6kBmP28XN60P8d0HmPKG4n9_4-bU'
2025-05-30 15:01:09,188 - auth - DEBUG - BOT_TOKEN length: 46
2025-05-30 15:01:09,188 - auth - DEBUG - init_data (repr): 'query_id=AAFreO00AAAAAGt47TSxQD0R&user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\\/\\/t.me\\/i\\/userpic\\/320\\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}&auth_date=1748606464&signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw&hash=94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7'
2025-05-30 15:01:09,190 - auth - DEBUG - received_hash: 94e901b9750d3cbb133e552109e7d44cdd3c073d5dd3793aacafff68f99e6fd7
2025-05-30 15:01:09,190 - auth - DEBUG - Data check string: auth_date=1748606464
query_id=AAFreO00AAAAAGt47TSxQD0R
signature=dHIeASBTJOWifS007aLqiPqNVNkAB94Jq9sBmN98DPSfPHoeM7fGYRFKlISOM0JoNXBqwdnhFanto8bYXb2yAw
user={"id":887978091,"first_name":".","last_name":".","username":"sar_a_to_v","language_code":"ru","allows_write_to_pm":true,"photo_url":"https:\/\/t.me\/i\/userpic\/320\/1RamL_iAFcdZ2kGPxN7DFOtBN-utHaDkfIu1okZ2zsA.svg"}
2025-05-30 15:01:09,190 - auth - DEBUG - Secret key created (first 5 bytes): b'\xa9N \x1e\xb2'
2025-05-30 15:01:09,190 - auth - DEBUG - Calculated hash: 76cc0eebdaeb1c0371e52ffb698b34980a0e13b1bb72d35d6d434b0836dc232e
2025-05-30 15:01:09,190 - auth - DEBUG - Hash verification result: False
2025-05-30 15:01:09,193 - auth - DEBUG - ==================================================

2025-05-30 15:01:09,193 - main - WARNING - Hash verification failed
2025-05-30 15:01:09,193 - main - ERROR - Authentication failed with HTTPException
2025-05-30 15:01:09,195 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 15:01:09,196 - main - ERROR - HTTP exception: 401 - Invalid hash
2025-05-30 15:01:09,197 - main - INFO - [5870ce04-148c-4df7-9e33-f186b2ab733b] Response status: 401 - Completed in 0.0726s
2025-05-30 15:01:09,198 - main - INFO - [037c324c-dedb-44ec-b50d-de6967d785f2] Response status: 401 - Completed in 0.0720s
